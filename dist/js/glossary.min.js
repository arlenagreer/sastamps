var SAPA_GLOSSARY=(()=>{var j=Object.defineProperty,q=Object.defineProperties;var X=Object.getOwnPropertyDescriptors;var v=Object.getOwnPropertySymbols;var G=Object.prototype.hasOwnProperty,x=Object.prototype.propertyIsEnumerable;var F=(e,t,r)=>t in e?j(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,R=(e,t)=>{for(var r in t||(t={}))G.call(t,r)&&F(e,r,t[r]);if(v)for(var r of v(t))x.call(t,r)&&F(e,r,t[r]);return e},N=(e,t)=>q(e,X(t));var $=(e,t)=>{var r={};for(var o in e)G.call(e,o)&&t.indexOf(o)<0&&(r[o]=e[o]);if(e!=null&&v)for(var o of v(e))t.indexOf(o)<0&&x.call(e,o)&&(r[o]=e[o]);return r};var Y={GA_MEASUREMENT_ID:"G-XXXXXXXXXX",EVENTS:{PAGE_VIEW:"page_view",FORM_SUBMIT:"form_submit",FILE_DOWNLOAD:"file_download",NEWSLETTER_DOWNLOAD:"newsletter_download",MEETING_RSVP:"meeting_rsvp",SEARCH:"search",RESOURCE_VIEW:"resource_view"}},Ee=N(R({},Y.EVENTS),{CONTACT_FORM_SUBMIT:"contact_form_submit",SEARCH_PERFORMED:"search_performed",REMINDER_SET:"reminder_set"});var T={PAGE_SIZE:10,MAX_SEARCH_RESULTS:50,IMAGE_QUALITY:.85,COMPRESSION_LEVEL:9,CACHE_DURATION:3600,SESSION_TIMEOUT:1800};var g={isDevelopment:window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1",isProduction:window.location.protocol==="https:",isDebug:window.location.search.includes("debug=true")},P={enableReminders:!0,enableAnalytics:g.isProduction,enableServiceWorker:g.isProduction,enableDebugLogging:g.isDevelopment||g.isDebug,enableCaching:!0,enableOfflineMode:!0},K={baseURL:g.isDevelopment?"http://localhost:3000":"",timeout:3e4,retries:3,cacheTimeout:T.CACHE_DURATION*1e3},z={prefix:"sapa_",version:"1.0",maxAge:T.SESSION_TIMEOUT*1e3},Q={formats:["webp","jpg"],sizes:[320,640,960,1280,1920],quality:T.IMAGE_QUALITY,lazyLoadOffset:50},J={minSearchLength:2,maxResults:T.MAX_SEARCH_RESULTS,debounceDelay:300,highlightMatches:!0},Z={autoSave:!0,autoSaveInterval:3e4,maxRetries:3,showProgressIndicator:!0},ee={defaultView:"month",firstDayOfWeek:0,showWeekNumbers:!1,allowPastDates:!1,maxFutureMonths:12},te={position:"top-right",duration:5e3,maxNotifications:3,soundEnabled:!1},re={enableLazyLoading:!0,enableCodeSplitting:!0,enablePrefetch:g.isProduction,enableCompression:g.isProduction,reportWebVitals:g.isProduction},oe={enableCSRF:!0,enableRateLimit:!0,rateLimitMax:3,rateLimitWindow:36e5,allowedOrigins:["https://sastamps.org","https://www.sastamps.org"]},O={level:g.isDevelopment?"debug":"error",enableConsole:!0,enableRemote:g.isProduction,remoteEndpoint:"/api/logs"};var se={env:g,features:P,api:K,storage:z,image:Q,search:J,form:Z,calendar:ee,notification:te,performance:re,security:oe,logging:O};Object.freeze(se);Object.freeze(g);Object.freeze(P);var c={DEBUG:0,INFO:1,WARN:2,ERROR:3,FATAL:4},h={[c.DEBUG]:"DEBUG",[c.INFO]:"INFO",[c.WARN]:"WARN",[c.ERROR]:"ERROR",[c.FATAL]:"FATAL"},I=class e{constructor(t="App",r=O){this.name=t,this.config=r,this.level=this.parseLevel(r.level)}parseLevel(t){return{debug:c.DEBUG,info:c.INFO,warn:c.WARN,error:c.ERROR,fatal:c.FATAL}[t.toLowerCase()]||c.INFO}shouldLog(t){return t>=this.level}formatMessage(t,r,o={}){return N(R({timestamp:new Date().toISOString(),level:h[t],logger:this.name,message:r},o),{url:window.location.href,userAgent:navigator.userAgent})}logToConsole(t){if(!this.config.enableConsole)return;let a=t,{level:r,message:o}=a,i=$(a,["level","message"]),s=`[${t.timestamp}] [${r}] [${this.name}]`;switch(r){case h[c.DEBUG]:console.debug(s,o,i);break;case h[c.INFO]:console.info(s,o,i);break;case h[c.WARN]:console.warn(s,o,i);break;case h[c.ERROR]:case h[c.FATAL]:console.error(s,o,i);break}}async logToRemote(t){if(!(!this.config.enableRemote||!g.isProduction))try{await fetch(this.config.remoteEndpoint,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})}catch(r){console.error("Failed to send log to remote:",r)}}log(t,r,o={}){if(!this.shouldLog(t))return;let i=this.formatMessage(t,r,o);this.logToConsole(i),t>=c.ERROR&&this.logToRemote(i)}debug(t,r={}){this.log(c.DEBUG,t,r)}info(t,r={}){this.log(c.INFO,t,r)}warn(t,r={}){this.log(c.WARN,t,r)}error(t,r={}){r instanceof Error&&(r={error:{message:r.message,stack:r.stack,name:r.name}}),this.log(c.ERROR,t,r)}fatal(t,r={}){r instanceof Error&&(r={error:{message:r.message,stack:r.stack,name:r.name}}),this.log(c.FATAL,t,r)}async time(t,r){let o=performance.now();try{let i=await r(),s=performance.now()-o;return this.debug(`${t} completed`,{duration:`${s.toFixed(2)}ms`}),i}catch(i){let s=performance.now()-o;throw this.error(`${t} failed`,{duration:`${s.toFixed(2)}ms`,error:i}),i}}child(t){return new e(`${this.name}:${t}`,this.config)}},Ae=new I;function S(e){return new I(e)}var ae=S("SafeDOM");function L(e,t=document){try{return t.querySelector(e)}catch(r){return ae.warn(`Failed to query selector "${e}":`,r),null}}function f(e){if(typeof e!="string")return"";let t=document.createElement("div");return t.textContent=e,t.innerHTML}var U=S("EventCleanup"),m=new Map;function y(e,t,r,o){if(!e||typeof e.addEventListener!="function"){U.warn("Invalid element provided to addEventListenerWithCleanup");return}e.addEventListener(t,r,o),m.has(e)||m.set(e,[]),m.get(e).push({event:t,handler:r,options:o})}function ne(e=null){if(e){let t=m.get(e);t&&(t.forEach(({event:r,handler:o,options:i})=>{e.removeEventListener(r,o,i)}),m.delete(e))}else m.forEach((t,r)=>{t.forEach(({event:o,handler:i,options:s})=>{try{r.removeEventListener(o,i,s)}catch(a){U.warn("Failed to remove event listener:",a)}})}),m.clear()}typeof window!="undefined"&&window.addEventListener("beforeunload",()=>{ne()});var A=S("GlossaryPage");async function C(){let e=L("#glossary-search-container");e&&await ie(e);let t=L("#glossary-filters-container");t&&await le(t);let r=L("#glossary-content-container");r&&await ce(r),await fe()}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",C):C();window.initializeGlossary=C;async function ie(e){try{e.innerHTML=`
            <div class="glossary-search">
                <div class="search-header">
                    <h3><i class="fas fa-search"></i> Search Glossary</h3>
                    <p>Find philatelic terms and definitions</p>
                </div>
                <div class="search-form">
                    <div class="search-input-group">
                        <input 
                            type="search" 
                            id="glossary-search-input" 
                            placeholder="Search terms, definitions, or categories..." 
                            aria-label="Search glossary terms"
                            autocomplete="off"
                        >
                        <button id="glossary-search-button" aria-label="Search" type="button">
                            <i class="fas fa-search"></i>
                        </button>
                        <button id="glossary-clear-button" aria-label="Clear search" type="button" style="display: none;">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    <div class="search-suggestions" id="search-suggestions" style="display: none;"></div>
                </div>
                <div id="search-results" style="display: none;"></div>
            </div>
        `;let t=e.querySelector("#glossary-search-input"),r=e.querySelector("#glossary-search-button"),o=e.querySelector("#glossary-clear-button"),i=e.querySelector("#search-results"),s;y(t,"input",a=>{clearTimeout(s);let n=a.target.value.trim();n.length>0?(o.style.display="block",s=setTimeout(()=>_(n,i),300)):(o.style.display="none",i.style.display="none",k())}),y(r,"click",()=>{let a=t.value.trim();a&&_(a,i)}),y(o,"click",()=>{t.value="",o.style.display="none",i.style.display="none",k(),t.focus()}),y(t,"keypress",a=>{if(a.key==="Enter"){a.preventDefault();let n=t.value.trim();n&&_(n,i)}})}catch(t){A.error("Failed to load glossary search:",t),e.innerHTML='<p class="error-message">Unable to load search functionality.</p>'}}async function le(e){try{let o=(await(await fetch("data/glossary/glossary.json")).json()).terms||[],i=[...new Set(o.map(l=>l.category))].sort(),s=[...new Set(o.map(l=>l.difficulty))].sort(),a=[...new Set(o.map(l=>l.subcategory).filter(Boolean))].sort();e.innerHTML=`
            <div class="glossary-filters">
                <div class="filters-grid">
                    <div class="filter-group">
                        <label for="category-filter">
                            <i class="fas fa-layer-group"></i> Category
                        </label>
                        <select id="category-filter" aria-label="Filter by category">
                            <option value="">All Categories</option>
                            ${i.map(l=>`<option value="${l}">${D(l)}</option>`).join("")}
                        </select>
                    </div>
                    
                    <div class="filter-group">
                        <label for="difficulty-filter">
                            <i class="fas fa-signal"></i> Difficulty
                        </label>
                        <select id="difficulty-filter" aria-label="Filter by difficulty">
                            <option value="">All Levels</option>
                            ${s.map(l=>`<option value="${l}">${w(l)}</option>`).join("")}
                        </select>
                    </div>
                    
                    <div class="filter-group">
                        <label for="sort-filter">
                            <i class="fas fa-sort"></i> Sort By
                        </label>
                        <select id="sort-filter" aria-label="Sort terms">
                            <option value="alphabetical">Alphabetical</option>
                            <option value="category">Category</option>
                            <option value="difficulty">Difficulty</option>
                            <option value="recent">Recently Added</option>
                        </select>
                    </div>
                    
                    <div class="filter-group">
                        <button id="filter-reset" type="button" class="btn btn-secondary">
                            <i class="fas fa-undo"></i> Reset Filters
                        </button>
                    </div>
                </div>
                
                <div class="alphabet-nav" id="alphabet-nav">
                    <span class="alphabet-label">Jump to letter:</span>
                    ${Array.from("ABCDEFGHIJKLMNOPQRSTUVWXYZ").map(l=>`<button class="alphabet-btn" data-letter="${l}">${l}</button>`).join("")}
                </div>
            </div>
        `;let n=e.querySelector("#category-filter"),d=e.querySelector("#difficulty-filter"),u=e.querySelector("#sort-filter"),p=e.querySelector("#filter-reset"),E=e.querySelectorAll(".alphabet-btn");[n,d,u].forEach(l=>{y(l,"change",H)}),y(p,"click",()=>{n.value="",d.value="",u.value="alphabetical",H()}),E.forEach(l=>{y(l,"click",M=>{let{letter:W}=M.target.dataset;ue(W),E.forEach(V=>V.classList.remove("active")),M.target.classList.add("active")})})}catch(t){A.error("Failed to load glossary filters:",t),e.innerHTML='<p class="error-message">Unable to load filters.</p>'}}async function ce(e){try{let o=(await(await fetch("data/glossary/glossary.json")).json()).terms||[];if(o.length===0){e.innerHTML=`
                <div class="card">
                    <div class="card-content text-center">
                        <h3>No Terms Available</h3>
                        <p>The glossary is currently being updated. Please check back soon.</p>
                    </div>
                </div>
            `;return}window.glossaryTerms=o,b(o,e)}catch(t){A.error("Failed to load glossary content:",t),e.innerHTML=`
            <div class="card">
                <div class="card-content text-center">
                    <h3>Error Loading Glossary</h3>
                    <p>Unable to load glossary terms. Please try refreshing the page.</p>
                </div>
            </div>
        `}}function b(e,t){if(e.length===0){t.innerHTML=`
            <div class="card">
                <div class="card-content text-center">
                    <h3>No Terms Found</h3>
                    <p>No terms match your current search or filter criteria.</p>
                </div>
            </div>
        `;return}let r={};e.forEach(s=>{let a=s.term.charAt(0).toUpperCase();r[a]||(r[a]=[]),r[a].push(s)});let i=Object.keys(r).sort().map(s=>`
        <div class="glossary-section" id="section-${s}">
            <h2 class="glossary-letter-header">${s}</h2>
            <div class="glossary-terms">
                ${r[s].map(a=>de(a)).join("")}
            </div>
        </div>
    `).join("");t.innerHTML=i,y(t,"click",s=>{if(s.target.closest(".term-header")){let a=s.target.closest(".glossary-term"),n=a.querySelector(".term-content"),d=a.querySelector(".expand-icon");n.style.display==="none"||!n.style.display?(n.style.display="block",d.style.transform="rotate(180deg)",a.classList.add("expanded")):(n.style.display="none",d.style.transform="rotate(0deg)",a.classList.remove("expanded"))}if(s.target.closest(".related-term")){s.preventDefault();let{termId:a}=s.target.closest(".related-term").dataset;B(a)}})}function de(e){let t=w(e.difficulty),r=D(e.category);return`
        <div class="glossary-term" id="term-${e.id}" data-term-id="${e.id}">
            <div class="term-header">
                <div class="term-title-group">
                    <h3 class="term-title">${f(e.term)}</h3>
                    ${e.alternateNames&&e.alternateNames.length>0?`<div class="alternate-names">
                            Also known as: ${e.alternateNames.map(o=>f(o)).join(", ")}
                        </div>`:""}
                </div>
                <div class="term-meta">
                    <span class="difficulty-badge difficulty-${e.difficulty}">${t}</span>
                    <span class="category-badge">${r}</span>
                    <i class="fas fa-chevron-down expand-icon"></i>
                </div>
            </div>
            
            <div class="term-content" style="display: none;">
                <div class="term-definition">
                    <p class="definition">${f(e.definition)}</p>
                    ${e.detailedDescription?`<div class="detailed-description">
                            <p>${f(e.detailedDescription)}</p>
                        </div>`:""}
                </div>
                
                ${e.examples&&e.examples.length>0?`
                    <div class="term-examples">
                        <h4><i class="fas fa-lightbulb"></i> Examples</h4>
                        <ul>
                            ${e.examples.map(o=>`
                                <li>
                                    ${f(o.description)}
                                    ${o.caption?`<span class="example-caption">${f(o.caption)}</span>`:""}
                                </li>
                            `).join("")}
                        </ul>
                    </div>
                `:""}
                
                ${e.etymology?`
                    <div class="term-etymology">
                        <h4><i class="fas fa-history"></i> Etymology</h4>
                        <p><strong>Origin:</strong> ${f(e.etymology.origin)}</p>
                        <p><strong>Meaning:</strong> ${f(e.etymology.meaning)}</p>
                        ${e.etymology.history?`<p><strong>History:</strong> ${f(e.etymology.history)}</p>`:""}
                    </div>
                `:""}
                
                ${e.relatedTerms&&e.relatedTerms.length>0?`
                    <div class="related-terms">
                        <h4><i class="fas fa-link"></i> Related Terms</h4>
                        <div class="related-terms-list">
                            ${e.relatedTerms.map(o=>`<a href="#term-${o}" class="related-term" data-term-id="${o}">${pe(o)}</a>`).join("")}
                        </div>
                    </div>
                `:""}
                
                ${e.tags&&e.tags.length>0?`
                    <div class="term-tags">
                        ${e.tags.map(o=>`<span class="tag">${f(o)}</span>`).join("")}
                    </div>
                `:""}
            </div>
        </div>
    `}async function _(e,t){try{let i=(await(await fetch("data/glossary/glossary.json")).json()).terms||[],s=e.toLowerCase(),a=i.filter(n=>n.term.toLowerCase().includes(s)||n.definition.toLowerCase().includes(s)||n.detailedDescription&&n.detailedDescription.toLowerCase().includes(s)||n.tags&&n.tags.some(d=>d.toLowerCase().includes(s))||n.category&&n.category.toLowerCase().includes(s)||n.alternateNames&&n.alternateNames.some(d=>d.toLowerCase().includes(s)));a.length===0?t.innerHTML=`
                <div class="search-no-results">
                    <p><strong>No results found for "${f(e)}"</strong></p>
                    <p>Try searching for related terms or browse by category.</p>
                </div>
            `:t.innerHTML=`
                <div class="search-results-header">
                    <p>Found <strong>${a.length}</strong> result${a.length!==1?"s":""} for "<strong>${f(e)}</strong>"</p>
                </div>
                <div class="search-results-list">
                    ${a.map(n=>`
                        <div class="search-result-item">
                            <h4><a href="#term-${n.id}" onclick="scrollToTerm('${n.id}')">${f(n.term)}</a></h4>
                            <p class="result-definition">${f(n.definition)}</p>
                            <div class="result-meta">
                                <span class="result-category">${D(n.category)}</span>
                                <span class="result-difficulty">${w(n.difficulty)}</span>
                            </div>
                        </div>
                    `).join("")}
                </div>
            `,t.style.display="block"}catch(r){A.error("Search failed:",r),t.innerHTML='<p class="error-message">Search temporarily unavailable. Please try again.</p>',t.style.display="block"}}function H(){var s,a,n;let e=((s=document.querySelector("#category-filter"))==null?void 0:s.value)||"",t=((a=document.querySelector("#difficulty-filter"))==null?void 0:a.value)||"",r=((n=document.querySelector("#sort-filter"))==null?void 0:n.value)||"alphabetical";if(!window.glossaryTerms)return;let o=[...window.glossaryTerms];switch(e&&(o=o.filter(d=>d.category===e)),t&&(o=o.filter(d=>d.difficulty===t)),r){case"category":o.sort((u,p)=>u.category!==p.category?u.category.localeCompare(p.category):u.term.localeCompare(p.term));break;case"difficulty":let d={beginner:1,intermediate:2,advanced:3};o.sort((u,p)=>{let E=d[u.difficulty]||999,l=d[p.difficulty]||999;return E!==l?E-l:u.term.localeCompare(p.term)});break;case"recent":o.sort((u,p)=>{let E=new Date(u.dateAdded||"1970-01-01");return new Date(p.dateAdded||"1970-01-01")-E});break;case"alphabetical":default:o.sort((u,p)=>u.term.localeCompare(p.term));break}let i=document.querySelector("#glossary-content-container");i&&b(o,i)}function k(){let e=document.querySelector("#glossary-content-container");e&&window.glossaryTerms&&b(window.glossaryTerms,e)}function ue(e){let t=document.querySelector(`#section-${e}`);t&&t.scrollIntoView({behavior:"smooth",block:"start"})}function B(e){let t=document.querySelector(`#term-${e}`);if(t){t.scrollIntoView({behavior:"smooth",block:"center"});let r=t.querySelector(".term-content"),o=t.querySelector(".expand-icon");r&&r.style.display!=="block"&&(r.style.display="block",o&&(o.style.transform="rotate(180deg)"),t.classList.add("expanded")),t.classList.add("highlighted"),setTimeout(()=>t.classList.remove("highlighted"),2e3)}}async function fe(){try{let r=(await(await fetch("data/glossary/glossary.json")).json()).terms||[],o=r.length,i=new Set(r.map(u=>u.category)).size,s=r.reduce((u,p)=>{var E;return u+(((E=p.relatedTerms)==null?void 0:E.length)||0)},0),a=document.querySelector("#total-terms"),n=document.querySelector("#total-categories"),d=document.querySelector("#total-references");a&&(a.textContent=o),n&&(n.textContent=i),d&&(d.textContent=s)}catch(e){A.error("Failed to load glossary stats:",e)}}function D(e){return e.split("-").map(t=>t.charAt(0).toUpperCase()+t.slice(1)).join(" ")}function w(e){return e.charAt(0).toUpperCase()+e.slice(1)}function pe(e){return e.split("-").map(t=>t.charAt(0).toUpperCase()+t.slice(1)).join(" ")}window.scrollToTerm=B;})();
