var SAPA_NEWSLETTER=(()=>{var A=Object.create;var g=Object.defineProperty;var C=Object.getOwnPropertyDescriptor;var x=Object.getOwnPropertyNames;var L=Object.getPrototypeOf,$=Object.prototype.hasOwnProperty;var E=(r,t)=>()=>(t||r((t={exports:{}}).exports,t),t.exports);var F=(r,t,n,a)=>{if(t&&typeof t=="object"||typeof t=="function")for(let e of x(t))!$.call(r,e)&&e!==n&&g(r,e,{get:()=>t[e],enumerable:!(a=C(t,e))||a.enumerable});return r};var y=(r,t,n)=>(n=r!=null?A(L(r)):{},F(t||!r||!r.__esModule?g(n,"default",{value:r,enumerable:!0}):n,r));var f=E((G,D)=>{D.exports={newsletters:[{id:"2025-Q3",title:"SAPA PHILATEX Third Quarter 2025",quarter:"Third",year:2025,publishDate:"2025-07-01",filePath:"public/SAPA-PHILATEX-Third-Quarter-2025.pdf",description:'Features the July-September meeting calendar, annual "Blue Chip" auction details, Greater Houston Stamp Show information, TSDA show schedule, 2025 membership drive, and programs on US Air Mail History and Classic Mexican Stamps.',featuredArticles:[{title:"US Air Mail History",category:"History",page:3},{title:"Classic Mexican Stamps",category:"Feature",page:5},{title:"Blue Chip Auction Preview",category:"News",page:7}],highlights:["July-September meeting calendar","Annual Blue Chip auction details","Greater Houston Stamp Show information","TSDA show schedule","2025 membership drive"],tags:["2025","auction","meetings","air-mail","mexican-stamps","houston-show"],pageCount:12,fileSize:"2.1 MB",status:"published"},{id:"2025-Q2",title:"SAPA PHILATEX Second Quarter 2025",quarter:"Second",year:2025,publishDate:"2025-04-01",filePath:"public/SAPA PHILATEX Second Quarter 2025.pdf",description:"Contains the April-June meeting schedule, club updates, member spotlights, and special features on recent philatelic discoveries and collecting tips for the spring season.",featuredArticles:[{title:"Spring Collecting Tips",category:"Collection Tips",page:2},{title:"Recent Philatelic Discoveries",category:"Feature",page:4},{title:"Member Spotlight: John Smith",category:"Member Spotlight",page:6}],highlights:["April-June meeting schedule","Club updates","Member spotlights","Recent philatelic discoveries","Spring collecting tips"],tags:["2025","spring","collecting-tips","discoveries","member-spotlight"],pageCount:10,fileSize:"1.8 MB",status:"published"}],metadata:{lastUpdated:"2025-06-28T17:26:00.000Z",totalIssues:2,latestIssue:"2025-Q3",version:"1.0"}}});function p(r,t){let n;return function(...e){let s=()=>{clearTimeout(n),r(...e)};clearTimeout(n),n=setTimeout(s,t)}}function d(r,t=document){try{return t.querySelector(r)}catch(n){return console.warn(`Failed to query selector "${r}":`,n),null}}var c=new Map;function o(r,t,n,a){if(!r||typeof r.addEventListener!="function"){console.warn("Invalid element provided to addEventListenerWithCleanup");return}r.addEventListener(t,n,a),c.has(r)||c.set(r,[]),c.get(r).push({event:t,handler:n,options:a})}function T(r=null){if(r){let t=c.get(r);t&&(t.forEach(({event:n,handler:a,options:e})=>{r.removeEventListener(n,a,e)}),c.delete(r))}else c.forEach((t,n)=>{t.forEach(({event:a,handler:e,options:s})=>{try{n.removeEventListener(a,e,s)}catch(i){console.warn("Failed to remove event listener:",i)}})}),c.clear()}typeof window<"u"&&window.addEventListener("beforeunload",()=>{T()});var m=class{constructor(){this.container=null,this.defaultHome={text:"Home",href:"/"},this.separator="\u203A"}init(t="breadcrumb-nav"){if(this.container=document.getElementById(t),!this.container){console.warn("Breadcrumb container not found");return}this.generateBreadcrumb()}generateBreadcrumb(){let t=window.location.pathname,n=t.split("/").filter(l=>l),a=[this.defaultHome],e=document.title.split(" - ")[0],s=n[n.length-1]||"index.html",i={"index.html":null,"meetings.html":{text:"Meetings",href:"/meetings.html"},"newsletter.html":{text:"Newsletters",href:"/newsletter.html"},"resources.html":{text:"Resources",href:"/resources.html"},"glossary.html":{text:"Glossary",href:"/glossary.html"},"contact.html":{text:"Contact",href:"/contact.html"},"search.html":{text:"Search",href:"/search.html"}};if(t.includes("/newsletters/")?(a.push({text:"Newsletters",href:"/newsletter.html"}),a.push({text:e,href:t,current:!0})):t.includes("/resources/")?(a.push({text:"Resources",href:"/resources.html"}),a.push({text:e,href:t,current:!0})):i[s]&&a.push({...i[s],current:!0}),a.length<=1){this.container.style.display="none";return}this.render(a)}render(t){let n=document.createElement("nav");n.setAttribute("aria-label","Breadcrumb"),n.className="breadcrumb-navigation";let a=document.createElement("ol");a.className="breadcrumb-list",t.forEach((e,s)=>{let i=document.createElement("li");if(i.className="breadcrumb-item",e.current)i.setAttribute("aria-current","page"),i.textContent=e.text;else{let l=document.createElement("a");l.href=e.href,l.textContent=e.text,i.appendChild(l)}if(a.appendChild(i),s<t.length-1){let l=document.createElement("span");l.className="breadcrumb-separator",l.setAttribute("aria-hidden","true"),l.textContent=` ${this.separator} `,a.appendChild(l)}}),n.appendChild(a),this.container.innerHTML="",this.container.appendChild(n)}setBreadcrumb(t){if(!this.container){console.warn("Breadcrumb not initialized");return}this.render([this.defaultHome,...t])}updateCurrent(t){let n=this.container.querySelector('[aria-current="page"]');n&&(n.textContent=t)}},w=new m;document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>w.init()):w.init();async function v(){let r=d("#newsletters-container");r&&await q(r);let t=d("#newsletter-search");t&&I(t);let n=d("#newsletter-filters");n&&B(n),W()}async function q(r){try{let{default:t}=await Promise.resolve().then(()=>y(f())),a=t.newsletters.sort((e,s)=>new Date(s.date)-new Date(e.date)).map(e=>`
            <article class="newsletter-item" data-date="${e.date}" data-year="${new Date(e.date).getFullYear()}">
                <div class="newsletter-preview">
                    ${e.coverImage?`<img src="${e.coverImage}" alt="Cover of ${e.title}" loading="lazy">`:'<div class="newsletter-placeholder">\u{1F4F0}</div>'}
                </div>
                
                <div class="newsletter-content">
                    <header class="newsletter-header">
                        <h3>${e.title}</h3>
                        <time datetime="${e.date}" class="newsletter-date">
                            ${new Date(e.date).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})}
                        </time>
                    </header>
                    
                    <div class="newsletter-details">
                        ${e.summary?`<p class="newsletter-summary">${e.summary}</p>`:""}
                        
                        ${e.features&&e.features.length>0?`
                            <div class="newsletter-features">
                                <h4>Featured Articles:</h4>
                                <ul>
                                    ${e.features.map(s=>`<li>${s}</li>`).join("")}
                                </ul>
                            </div>
                        `:""}
                        
                        <div class="newsletter-meta">
                            <span class="newsletter-pages">${e.pages||"Multiple"} pages</span>
                            ${e.fileSize?`<span class="newsletter-size">${e.fileSize}</span>`:""}
                        </div>
                    </div>
                    
                    <footer class="newsletter-actions">
                        <a href="${e.pdfUrl}" target="_blank" class="btn-primary btn-view-pdf" data-newsletter-id="${e.id}">
                            \u{1F4C4} View PDF
                        </a>
                        <button class="btn-secondary btn-download" data-url="${e.pdfUrl}" data-title="${e.title}">
                            \u{1F4BE} Download
                        </button>
                        ${e.articleLinks&&e.articleLinks.length>0?`
                            <details class="newsletter-articles">
                                <summary>Articles (${e.articleLinks.length})</summary>
                                <ul>
                                    ${e.articleLinks.map(s=>`
                                        <li><a href="${s.url}" target="_blank">${s.title}</a></li>
                                    `).join("")}
                                </ul>
                            </details>
                        `:""}
                    </footer>
                </div>
            </article>
        `).join("");r.innerHTML=a,z(r)}catch(t){console.error("Failed to load newsletters:",t),r.innerHTML='<p class="error-message">Unable to load newsletters. Please try again later.</p>'}}function I(r){r.innerHTML=`
        <div class="search-container">
            <input type="search" id="newsletter-search-input" placeholder="Search newsletters..." aria-label="Search newsletters">
            <button id="newsletter-search-button" aria-label="Search">\u{1F50D}</button>
        </div>
        <div id="search-results" class="search-results" aria-live="polite"></div>
    `;let t=r.querySelector("#newsletter-search-input"),n=r.querySelector("#newsletter-search-button"),a=r.querySelector("#search-results"),e=p(async s=>{if(!s.trim()){a.innerHTML="",H();return}try{let{default:i}=await Promise.resolve().then(()=>y(f())),l=M(i.newsletters,s);l.length===0?(a.innerHTML="<p>No newsletters found matching your search.</p>",P()):(a.innerHTML=`<p>Found ${l.length} newsletter${l.length!==1?"s":""}</p>`,N(l))}catch(i){console.error("Search failed:",i),a.innerHTML="<p>Search temporarily unavailable.</p>"}},300);o(t,"input",s=>{e(s.target.value)}),o(n,"click",()=>{e(t.value)}),o(t,"keypress",s=>{s.key==="Enter"&&e(t.value)})}function M(r,t){let n=t.toLowerCase().split(" ");return r.filter(a=>{let e=[a.title,a.summary,...a.features||[],new Date(a.date).toLocaleDateString()].join(" ").toLowerCase();return n.every(s=>e.includes(s))})}function N(r){document.querySelectorAll(".newsletter-item").forEach(n=>{let a=n.dataset.date,e=r.some(s=>s.date===a);n.style.display=e?"block":"none"})}function H(){document.querySelectorAll(".newsletter-item").forEach(t=>{t.style.display="block"})}function P(){document.querySelectorAll(".newsletter-item").forEach(t=>{t.style.display="none"})}function B(r){let t=new Date().getFullYear(),n=Array.from({length:5},(l,u)=>t-u);r.innerHTML=`
        <div class="filter-group">
            <label for="year-filter">Year:</label>
            <select id="year-filter">
                <option value="">All Years</option>
                ${n.map(l=>`<option value="${l}">${l}</option>`).join("")}
            </select>
        </div>
        
        <div class="filter-group">
            <label for="sort-filter">Sort By:</label>
            <select id="sort-filter">
                <option value="date-desc">Newest First</option>
                <option value="date-asc">Oldest First</option>
                <option value="title-asc">Title A-Z</option>
                <option value="title-desc">Title Z-A</option>
            </select>
        </div>
        
        <button id="clear-filters" class="btn-secondary">Clear Filters</button>
    `;let a=r.querySelector("#year-filter"),e=r.querySelector("#sort-filter"),s=r.querySelector("#clear-filters"),i=p(()=>{let l=document.querySelectorAll(".newsletter-item"),u=a.value,S=e.value,b=Array.from(l).filter(h=>u&&h.dataset.year!==u?(h.style.display="none",!1):(h.style.display="block",!0));k(b,S)},300);o(a,"change",i),o(e,"change",i),o(s,"click",()=>{a.value="",e.value="date-desc",i()})}function k(r,t){let n=r[0]?.parentElement;n&&(r.sort((a,e)=>{switch(t){case"date-desc":return new Date(e.dataset.date)-new Date(a.dataset.date);case"date-asc":return new Date(a.dataset.date)-new Date(e.dataset.date);case"title-asc":return a.querySelector("h3").textContent.localeCompare(e.querySelector("h3").textContent);case"title-desc":return e.querySelector("h3").textContent.localeCompare(a.querySelector("h3").textContent);default:return 0}}),r.forEach(a=>{n.appendChild(a)}))}function z(r){r.querySelectorAll(".btn-download").forEach(a=>{o(a,"click",e=>{let s=e.target.dataset.url,i=e.target.dataset.title;Q(s,i)})}),r.querySelectorAll(".btn-view-pdf").forEach(a=>{o(a,"click",e=>{let s=e.target.dataset.newsletterId;J(s)})})}function Q(r,t){try{let n=document.createElement("a");n.href=r,n.download=`${t}.pdf`,n.style.display="none",document.body.appendChild(n),n.click(),document.body.removeChild(n),U(t)}catch(n){console.error("Download failed:",n),alert("Download failed. Please try opening the PDF in a new tab.")}}function J(r){typeof gtag=="function"&&gtag("event","newsletter_view",{newsletter_id:r})}function U(r){typeof gtag=="function"&&gtag("event","newsletter_download",{newsletter_title:r})}function W(){console.log("PDF viewer initialization placeholder")}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",v):v();})();
