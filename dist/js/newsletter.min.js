var SAPA_NEWSLETTER=(()=>{var S=Object.create;var m=Object.defineProperty;var b=Object.getOwnPropertyDescriptor;var A=Object.getOwnPropertyNames;var L=Object.getPrototypeOf,$=Object.prototype.hasOwnProperty;var C=(e,r)=>()=>(r||e((r={exports:{}}).exports,r),r.exports);var F=(e,r,a,n)=>{if(r&&typeof r=="object"||typeof r=="function")for(let t of A(r))!$.call(e,t)&&t!==a&&m(e,t,{get:()=>r[t],enumerable:!(n=b(r,t))||n.enumerable});return e};var g=(e,r,a)=>(a=e!=null?S(L(e)):{},F(r||!e||!e.__esModule?m(a,"default",{value:e,enumerable:!0}):a,e));var h=C((j,D)=>{D.exports={newsletters:[{id:"2025-Q3",title:"SAPA PHILATEX Third Quarter 2025",quarter:"Third",year:2025,publishDate:"2025-07-01",filePath:"public/SAPA-PHILATEX-Third-Quarter-2025.pdf",description:'Features the July-September meeting calendar, annual "Blue Chip" auction details, Greater Houston Stamp Show information, TSDA show schedule, 2025 membership drive, and programs on US Air Mail History and Classic Mexican Stamps.',featuredArticles:[{title:"US Air Mail History",category:"History",page:3},{title:"Classic Mexican Stamps",category:"Feature",page:5},{title:"Blue Chip Auction Preview",category:"News",page:7}],highlights:["July-September meeting calendar","Annual Blue Chip auction details","Greater Houston Stamp Show information","TSDA show schedule","2025 membership drive"],tags:["2025","auction","meetings","air-mail","mexican-stamps","houston-show"],pageCount:12,fileSize:"2.1 MB",status:"published"},{id:"2025-Q2",title:"SAPA PHILATEX Second Quarter 2025",quarter:"Second",year:2025,publishDate:"2025-04-01",filePath:"public/SAPA PHILATEX Second Quarter 2025.pdf",description:"Contains the April-June meeting schedule, club updates, member spotlights, and special features on recent philatelic discoveries and collecting tips for the spring season.",featuredArticles:[{title:"Spring Collecting Tips",category:"Collection Tips",page:2},{title:"Recent Philatelic Discoveries",category:"Feature",page:4},{title:"Member Spotlight: John Smith",category:"Member Spotlight",page:6}],highlights:["April-June meeting schedule","Club updates","Member spotlights","Recent philatelic discoveries","Spring collecting tips"],tags:["2025","spring","collecting-tips","discoveries","member-spotlight"],pageCount:10,fileSize:"1.8 MB",status:"published"}],metadata:{lastUpdated:"2025-06-28T17:26:00.000Z",totalIssues:2,latestIssue:"2025-Q3",version:"1.0"}}});function f(e,r){let a;return function(...t){let l=()=>{clearTimeout(a),e(...t)};clearTimeout(a),a=setTimeout(l,r)}}function d(e,r=document){try{return r.querySelector(e)}catch(a){return console.warn(`Failed to query selector "${e}":`,a),null}}var c=new Map;function s(e,r,a,n){if(!e||typeof e.addEventListener!="function"){console.warn("Invalid element provided to addEventListenerWithCleanup");return}e.addEventListener(r,a,n),c.has(e)||c.set(e,[]),c.get(e).push({event:r,handler:a,options:n})}function T(e=null){if(e){let r=c.get(e);r&&(r.forEach(({event:a,handler:n,options:t})=>{e.removeEventListener(a,n,t)}),c.delete(e))}else c.forEach((r,a)=>{r.forEach(({event:n,handler:t,options:l})=>{try{a.removeEventListener(n,t,l)}catch(i){console.warn("Failed to remove event listener:",i)}})}),c.clear()}typeof window<"u"&&window.addEventListener("beforeunload",()=>{T()});async function y(){let e=d("#newsletters-container");e&&await E(e);let r=d("#newsletter-search");r&&x(r);let a=d("#newsletter-filters");a&&N(a),J()}async function E(e){try{let{default:r}=await Promise.resolve().then(()=>g(h())),n=r.newsletters.sort((t,l)=>new Date(l.date)-new Date(t.date)).map(t=>`
            <article class="newsletter-item" data-date="${t.date}" data-year="${new Date(t.date).getFullYear()}">
                <div class="newsletter-preview">
                    ${t.coverImage?`<img src="${t.coverImage}" alt="Cover of ${t.title}" loading="lazy">`:'<div class="newsletter-placeholder">\u{1F4F0}</div>'}
                </div>
                
                <div class="newsletter-content">
                    <header class="newsletter-header">
                        <h3>${t.title}</h3>
                        <time datetime="${t.date}" class="newsletter-date">
                            ${new Date(t.date).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})}
                        </time>
                    </header>
                    
                    <div class="newsletter-details">
                        ${t.summary?`<p class="newsletter-summary">${t.summary}</p>`:""}
                        
                        ${t.features&&t.features.length>0?`
                            <div class="newsletter-features">
                                <h4>Featured Articles:</h4>
                                <ul>
                                    ${t.features.map(l=>`<li>${l}</li>`).join("")}
                                </ul>
                            </div>
                        `:""}
                        
                        <div class="newsletter-meta">
                            <span class="newsletter-pages">${t.pages||"Multiple"} pages</span>
                            ${t.fileSize?`<span class="newsletter-size">${t.fileSize}</span>`:""}
                        </div>
                    </div>
                    
                    <footer class="newsletter-actions">
                        <a href="${t.pdfUrl}" target="_blank" class="btn-primary btn-view-pdf" data-newsletter-id="${t.id}">
                            \u{1F4C4} View PDF
                        </a>
                        <button class="btn-secondary btn-download" data-url="${t.pdfUrl}" data-title="${t.title}">
                            \u{1F4BE} Download
                        </button>
                        ${t.articleLinks&&t.articleLinks.length>0?`
                            <details class="newsletter-articles">
                                <summary>Articles (${t.articleLinks.length})</summary>
                                <ul>
                                    ${t.articleLinks.map(l=>`
                                        <li><a href="${l.url}" target="_blank">${l.title}</a></li>
                                    `).join("")}
                                </ul>
                            </details>
                        `:""}
                    </footer>
                </div>
            </article>
        `).join("");e.innerHTML=n,H(e)}catch(r){console.error("Failed to load newsletters:",r),e.innerHTML='<p class="error-message">Unable to load newsletters. Please try again later.</p>'}}function x(e){e.innerHTML=`
        <div class="search-container">
            <input type="search" id="newsletter-search-input" placeholder="Search newsletters..." aria-label="Search newsletters">
            <button id="newsletter-search-button" aria-label="Search">\u{1F50D}</button>
        </div>
        <div id="search-results" class="search-results" aria-live="polite"></div>
    `;let r=e.querySelector("#newsletter-search-input"),a=e.querySelector("#newsletter-search-button"),n=e.querySelector("#search-results"),t=f(async l=>{if(!l.trim()){n.innerHTML="",M();return}try{let{default:i}=await Promise.resolve().then(()=>g(h())),o=q(i.newsletters,l);o.length===0?(n.innerHTML="<p>No newsletters found matching your search.</p>",P()):(n.innerHTML=`<p>Found ${o.length} newsletter${o.length!==1?"s":""}</p>`,I(o))}catch(i){console.error("Search failed:",i),n.innerHTML="<p>Search temporarily unavailable.</p>"}},300);s(r,"input",l=>{t(l.target.value)}),s(a,"click",()=>{t(r.value)}),s(r,"keypress",l=>{l.key==="Enter"&&t(r.value)})}function q(e,r){let a=r.toLowerCase().split(" ");return e.filter(n=>{let t=[n.title,n.summary,...n.features||[],new Date(n.date).toLocaleDateString()].join(" ").toLowerCase();return a.every(l=>t.includes(l))})}function I(e){document.querySelectorAll(".newsletter-item").forEach(a=>{let n=a.dataset.date,t=e.some(l=>l.date===n);a.style.display=t?"block":"none"})}function M(){document.querySelectorAll(".newsletter-item").forEach(r=>{r.style.display="block"})}function P(){document.querySelectorAll(".newsletter-item").forEach(r=>{r.style.display="none"})}function N(e){let r=new Date().getFullYear(),a=Array.from({length:5},(o,u)=>r-u);e.innerHTML=`
        <div class="filter-group">
            <label for="year-filter">Year:</label>
            <select id="year-filter">
                <option value="">All Years</option>
                ${a.map(o=>`<option value="${o}">${o}</option>`).join("")}
            </select>
        </div>
        
        <div class="filter-group">
            <label for="sort-filter">Sort By:</label>
            <select id="sort-filter">
                <option value="date-desc">Newest First</option>
                <option value="date-asc">Oldest First</option>
                <option value="title-asc">Title A-Z</option>
                <option value="title-desc">Title Z-A</option>
            </select>
        </div>
        
        <button id="clear-filters" class="btn-secondary">Clear Filters</button>
    `;let n=e.querySelector("#year-filter"),t=e.querySelector("#sort-filter"),l=e.querySelector("#clear-filters"),i=f(()=>{let o=document.querySelectorAll(".newsletter-item"),u=n.value,w=t.value,v=Array.from(o).filter(p=>u&&p.dataset.year!==u?(p.style.display="none",!1):(p.style.display="block",!0));k(v,w)},300);s(n,"change",i),s(t,"change",i),s(l,"click",()=>{n.value="",t.value="date-desc",i()})}function k(e,r){let a=e[0]?.parentElement;a&&(e.sort((n,t)=>{switch(r){case"date-desc":return new Date(t.dataset.date)-new Date(n.dataset.date);case"date-asc":return new Date(n.dataset.date)-new Date(t.dataset.date);case"title-asc":return n.querySelector("h3").textContent.localeCompare(t.querySelector("h3").textContent);case"title-desc":return t.querySelector("h3").textContent.localeCompare(n.querySelector("h3").textContent);default:return 0}}),e.forEach(n=>{a.appendChild(n)}))}function H(e){e.querySelectorAll(".btn-download").forEach(n=>{s(n,"click",t=>{let l=t.target.dataset.url,i=t.target.dataset.title;B(l,i)})}),e.querySelectorAll(".btn-view-pdf").forEach(n=>{s(n,"click",t=>{let l=t.target.dataset.newsletterId;z(l)})})}function B(e,r){try{let a=document.createElement("a");a.href=e,a.download=`${r}.pdf`,a.style.display="none",document.body.appendChild(a),a.click(),document.body.removeChild(a),Q(r)}catch(a){console.error("Download failed:",a),alert("Download failed. Please try opening the PDF in a new tab.")}}function z(e){typeof gtag=="function"&&gtag("event","newsletter_view",{newsletter_id:e})}function Q(e){typeof gtag=="function"&&gtag("event","newsletter_download",{newsletter_title:e})}function J(){console.log("PDF viewer initialization placeholder")}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",y):y();})();
