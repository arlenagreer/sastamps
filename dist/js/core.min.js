var SAPA_CORE=(()=>{var h=Object.defineProperty;var k=Object.getOwnPropertyDescriptor;var U=Object.getOwnPropertyNames;var P=Object.prototype.hasOwnProperty;var W=(r,e)=>{for(var t in e)h(r,t,{get:e[t],enumerable:!0})},H=(r,e,t,o)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of U(e))!P.call(r,n)&&n!==t&&h(r,n,{get:()=>e[n],enumerable:!(o=k(e,n))||o.enumerable});return r};var B=r=>H(h({},"__esModule",{value:!0}),r);var oe={};W(oe,{ErrorBoundary:()=>p,addEventListenerWithCleanup:()=>v,cleanupEventListeners:()=>R,debounce:()=>O,globalErrorBoundary:()=>b,initializeTheme:()=>w,registerServiceWorker:()=>D,safeLocalStorageGet:()=>d,safeLocalStorageSet:()=>f,safeQuerySelector:()=>y,throttle:()=>L,toggleTheme:()=>C});var c={DEBOUNCE_DEFAULT:500,DEBOUNCE_SEARCH:300,THROTTLE_DEFAULT:1e3,ANIMATION_FRAME_FALLBACK:16,NOTIFICATION_AUTO_DISMISS:1e4,NOTIFICATION_SHORT:2e3,REMINDER_CHECK_INTERVAL:6e4,REMINDER_AUTO_DISMISS:15e3,COPY_FEEDBACK_DURATION:1500,FORM_MESSAGE_SUCCESS_DURATION:1e4,RSVP_CONFIRMATION_DURATION:3e3,RETRY_DELAY_BASE:1e3,SERVICE_WORKER_UPDATE_DISMISS:1e4};var S={GENERIC:"An error occurred. Please try again.",NETWORK:"Network error. Please check your connection.",VALIDATION_FAILED:"Please correct the errors above before submitting.",LOAD_FAILED:"Failed to load content. Please try again.",SUBMISSION_FAILED:"Sorry, there was an error sending your message. Please try again.",CALENDAR_UNAVAILABLE:"Calendar temporarily unavailable. Please try refreshing the page.",MEETING_LOAD_FAILED:"Unable to load meetings. Please try again later.",REMINDER_PERMISSION_DENIED:"Notification permission was denied.",COPY_FAILED:"Failed to copy to clipboard."};var T={GA_MEASUREMENT_ID:"G-XXXXXXXXXX",EVENTS:{PAGE_VIEW:"page_view",FORM_SUBMIT:"form_submit",FILE_DOWNLOAD:"file_download",NEWSLETTER_DOWNLOAD:"newsletter_download",MEETING_RSVP:"meeting_rsvp",SEARCH:"search",RESOURCE_VIEW:"resource_view"}},ae={...T.EVENTS,CONTACT_FORM_SUBMIT:"contact_form_submit",SEARCH_PERFORMED:"search_performed",REMINDER_SET:"reminder_set"};var m={PAGE_SIZE:10,MAX_SEARCH_RESULTS:50,IMAGE_QUALITY:.85,COMPRESSION_LEVEL:9,CACHE_DURATION:3600,SESSION_TIMEOUT:1800};function O(r,e=c.DEBOUNCE_DEFAULT){if(typeof r!="function")throw new TypeError("First argument must be a function");let t;return function(...n){let i=()=>{clearTimeout(t),r(...n)};clearTimeout(t),t=setTimeout(i,e)}}function L(r,e=c.THROTTLE_DEFAULT){if(typeof r!="function")throw new TypeError("First argument must be a function");let t;return function(...n){t||(r.apply(this,n),t=!0,setTimeout(()=>t=!1,e))}}function y(r,e=document){try{return e.querySelector(r)}catch(t){return console.warn(`Failed to query selector "${r}":`,t),null}}function d(r,e=null){try{let t=localStorage.getItem(r);return t!==null?JSON.parse(t):e}catch(t){return console.warn(`Failed to get localStorage item "${r}":`,t),e}}function f(r,e){try{return localStorage.setItem(r,JSON.stringify(e)),!0}catch(t){return console.warn(`Failed to set localStorage item "${r}":`,t),!1}}var p=class{constructor(e={}){this.componentName=e.componentName||"Unknown Component",this.fallbackUI=e.fallbackUI||this.createDefaultFallback(),this.onError=e.onError||this.defaultErrorHandler,this.retryCallback=e.retryCallback||null,this.maxRetries=e.maxRetries||0,this.currentRetries=0,this.container=e.container||null}wrap(e,t=null){return(...o)=>{try{let n=e.apply(t,o);return n&&typeof n.catch=="function"?n.catch(i=>this.handleError(i)):n}catch(n){return this.handleError(n)}}}wrapAsync(e,t=null){return async(...o)=>{try{return await e.apply(t,o)}catch(n){return this.handleError(n)}}}handleError(e){return console.error(`[${this.componentName}] Error caught by boundary:`,e),this.onError(e,this.componentName),this.container&&this.showFallbackUI(e),this.retryCallback&&this.currentRetries<this.maxRetries&&(this.currentRetries++,console.log(`[${this.componentName}] Retrying... (${this.currentRetries}/${this.maxRetries})`),setTimeout(()=>{try{this.retryCallback()}catch(t){console.error(`[${this.componentName}] Retry failed:`,t)}},1e3*this.currentRetries)),null}showFallbackUI(e){if(!this.container)return;let t=typeof this.fallbackUI=="function"?this.fallbackUI(e,this.componentName):this.fallbackUI;if(this.container.innerHTML="",typeof t=="string"?this.container.innerHTML=t:t instanceof HTMLElement&&this.container.appendChild(t),this.retryCallback&&this.currentRetries<this.maxRetries){let o=document.createElement("button");o.textContent="Retry",o.className="btn btn-primary mt-2",o.onclick=()=>{this.container.innerHTML="",this.retryCallback()},this.container.appendChild(o)}}createDefaultFallback(){return(e,t)=>`
            <div class="error-boundary-fallback" style="
                background-color: #f8d7da;
                color: #721c24;
                border: 1px solid #f5c6cb;
                border-radius: 0.375rem;
                padding: 1rem;
                margin: 1rem 0;
                text-align: center;
            ">
                <h4 style="margin-bottom: 0.5rem;">
                    <i class="fas fa-exclamation-triangle"></i>
                    Something went wrong
                </h4>
                <p style="margin-bottom: 0.5rem;">
                    The ${t} component encountered an error and couldn't load properly.
                </p>
                <details style="margin-top: 0.5rem; font-size: 0.875rem;">
                    <summary style="cursor: pointer; color: #495057;">
                        Technical Details
                    </summary>
                    <pre style="
                        background-color: #f8f9fa;
                        padding: 0.5rem;
                        border-radius: 0.25rem;
                        margin-top: 0.5rem;
                        overflow-x: auto;
                        font-size: 0.75rem;
                        text-align: left;
                    ">${e.message}
${e.stack||""}</pre>
                </details>
            </div>
        `}defaultErrorHandler(e,t){console.error(`[ErrorBoundary] ${t}:`,e),typeof gtag<"u"&&gtag("event","exception",{description:`${t}: ${e.message}`,fatal:!1});try{let o=JSON.parse(localStorage.getItem("errorBoundaryLog")||"[]");o.push({timestamp:new Date().toISOString(),component:t,message:e.message,stack:e.stack,userAgent:navigator.userAgent}),o.length>50&&o.splice(0,o.length-50),localStorage.setItem("errorBoundaryLog",JSON.stringify(o))}catch(o){console.warn("Failed to log error to localStorage:",o)}}reset(){this.currentRetries=0}},A=class{constructor(){this.setupGlobalHandlers(),this.errorCount=0,this.maxErrors=10,this.timeWindow=6e4,this.errorTimes=[]}setupGlobalHandlers(){window.addEventListener("error",e=>{this.handleGlobalError(e.error,e.filename,e.lineno,e.colno)}),window.addEventListener("unhandledrejection",e=>{this.handleGlobalError(e.reason,"Promise rejection",0,0),e.preventDefault()})}handleGlobalError(e,t,o,n){let i=Date.now();if(this.errorTimes=this.errorTimes.filter(G=>i-G<this.timeWindow),this.errorTimes.length>=this.maxErrors){console.warn("Too many errors detected. Stopping error boundary logging to prevent spam.");return}this.errorTimes.push(i);let E={message:e?.message||e||"Unknown error",source:t||"Unknown source",line:o||0,column:n||0,stack:e?.stack||"",timestamp:new Date().toISOString(),userAgent:navigator.userAgent,url:window.location.href};console.error("[GlobalErrorBoundary] Uncaught error:",E),typeof gtag<"u"&&gtag("event","exception",{description:`Global: ${E.message}`,fatal:!1}),this.showErrorNotification(E)}showErrorNotification(e){let t=document.getElementById("global-error-notification");t||(t=document.createElement("div"),t.id="global-error-notification",t.style.cssText=`
                position: fixed;
                top: 20px;
                right: 20px;
                background-color: #f8d7da;
                color: #721c24;
                border: 1px solid #f5c6cb;
                border-radius: 0.375rem;
                padding: 1rem;
                max-width: 300px;
                z-index: 9999;
                box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
                display: none;
            `,t.innerHTML=`
                <div style="display: flex; align-items: center; justify-content: space-between;">
                    <span style="font-weight: bold;">
                        <i class="fas fa-exclamation-triangle"></i>
                        Something went wrong
                    </span>
                    <button id="close-error-notification" style="
                        background: none;
                        border: none;
                        font-size: 1.2rem;
                        cursor: pointer;
                        color: #721c24;
                        padding: 0;
                        margin-left: 0.5rem;
                    ">&times;</button>
                </div>
                <p style="margin: 0.5rem 0 0 0; font-size: 0.875rem;">
                    We've encountered an unexpected error. The page may not work correctly.
                    Please refresh to try again.
                </p>
            `,document.body.appendChild(t),document.getElementById("close-error-notification").onclick=()=>{t.style.display="none"},setTimeout(()=>{t&&(t.style.display="none")},1e4)),t.style.display="block"}},b=new A;function w(){let r=d("theme","light");I(r),window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",V)}function C(){let e=$()==="dark"?"light":"dark";return I(e),f("theme",e),e}function $(){return document.documentElement.getAttribute("data-theme")||"light"}function I(r){document.documentElement.setAttribute("data-theme",r);let e=document.querySelector('meta[name="theme-color"]');e&&e.setAttribute("content",r==="dark"?"#1a1a1a":"#ffffff"),window.dispatchEvent(new CustomEvent("themechange",{detail:{theme:r}}))}function V(r){if(!d("theme")){let t=r.matches?"dark":"light";I(t)}}async function D(){if("serviceWorker"in navigator)try{let r=await navigator.serviceWorker.register("/sw.js",{scope:"/"});return r.addEventListener("updatefound",()=>{let e=r.installing;e&&e.addEventListener("statechange",()=>{e.state==="installed"&&navigator.serviceWorker.controller&&Y()})}),r}catch(r){return console.warn("Service worker registration failed:",r),null}else return null}function Y(){let r=document.createElement("div");r.className="update-notification",r.innerHTML=`
        <div class="update-content">
            <p>A new version of the site is available!</p>
            <button class="btn-update">Update Now</button>
            <button class="btn-dismiss">Dismiss</button>
        </div>
    `,document.body.appendChild(r),r.querySelector(".btn-update").addEventListener("click",()=>{window.location.reload()}),r.querySelector(".btn-dismiss").addEventListener("click",()=>{r.remove()}),setTimeout(()=>{r.parentNode&&r.remove()},c.SERVICE_WORKER_UPDATE_DISMISS)}var l=new Map;function v(r,e,t,o){if(!r||typeof r.addEventListener!="function"){console.warn("Invalid element provided to addEventListenerWithCleanup");return}r.addEventListener(e,t,o),l.has(r)||l.set(r,[]),l.get(r).push({event:e,handler:t,options:o})}function R(r=null){if(r){let e=l.get(r);e&&(e.forEach(({event:t,handler:o,options:n})=>{r.removeEventListener(t,o,n)}),l.delete(r))}else l.forEach((e,t)=>{e.forEach(({event:o,handler:n,options:i})=>{try{t.removeEventListener(o,n,i)}catch(E){console.warn("Failed to remove event listener:",E)}})}),l.clear()}typeof window<"u"&&window.addEventListener("beforeunload",()=>{R()});var s={isDevelopment:window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1",isProduction:window.location.protocol==="https:",isDebug:window.location.search.includes("debug=true")},x={enableReminders:!0,enableAnalytics:s.isProduction,enableServiceWorker:s.isProduction,enableDebugLogging:s.isDevelopment||s.isDebug,enableCaching:!0,enableOfflineMode:!0},X={baseURL:s.isDevelopment?"http://localhost:3000":"",timeout:3e4,retries:3,cacheTimeout:m.CACHE_DURATION*1e3},z={prefix:"sapa_",version:"1.0",maxAge:m.SESSION_TIMEOUT*1e3},K={formats:["webp","jpg"],sizes:[320,640,960,1280,1920],quality:m.IMAGE_QUALITY,lazyLoadOffset:50},j={minSearchLength:2,maxResults:m.MAX_SEARCH_RESULTS,debounceDelay:300,highlightMatches:!0},q={autoSave:!0,autoSaveInterval:3e4,maxRetries:3,showProgressIndicator:!0},Q={defaultView:"month",firstDayOfWeek:0,showWeekNumbers:!1,allowPastDates:!1,maxFutureMonths:12},J={position:"top-right",duration:5e3,maxNotifications:3,soundEnabled:!1},Z={enableLazyLoading:!0,enableCodeSplitting:!0,enablePrefetch:s.isProduction,enableCompression:s.isProduction,reportWebVitals:s.isProduction},ee={enableCSRF:!0,enableRateLimit:!0,rateLimitMax:3,rateLimitWindow:36e5,allowedOrigins:["https://sastamps.org","https://www.sastamps.org"]},N={level:s.isDevelopment?"debug":"error",enableConsole:!0,enableRemote:s.isProduction,remoteEndpoint:"/api/logs"};var te={env:s,features:x,api:X,storage:z,image:K,search:j,form:q,calendar:Q,notification:J,performance:Z,security:ee,logging:N};Object.freeze(te);Object.freeze(s);Object.freeze(x);var a={DEBUG:0,INFO:1,WARN:2,ERROR:3,FATAL:4},u={[a.DEBUG]:"DEBUG",[a.INFO]:"INFO",[a.WARN]:"WARN",[a.ERROR]:"ERROR",[a.FATAL]:"FATAL"},g=class r{constructor(e="App",t=N){this.name=e,this.config=t,this.level=this.parseLevel(t.level)}parseLevel(e){return{debug:a.DEBUG,info:a.INFO,warn:a.WARN,error:a.ERROR,fatal:a.FATAL}[e.toLowerCase()]||a.INFO}shouldLog(e){return e>=this.level}formatMessage(e,t,o={}){return{timestamp:new Date().toISOString(),level:u[e],logger:this.name,message:t,...o,url:window.location.href,userAgent:navigator.userAgent}}logToConsole(e){if(!this.config.enableConsole)return;let{level:t,message:o,...n}=e,i=`[${e.timestamp}] [${t}] [${this.name}]`;switch(t){case u[a.DEBUG]:console.debug(i,o,n);break;case u[a.INFO]:console.info(i,o,n);break;case u[a.WARN]:console.warn(i,o,n);break;case u[a.ERROR]:case u[a.FATAL]:console.error(i,o,n);break}}async logToRemote(e){if(!(!this.config.enableRemote||!s.isProduction))try{await fetch(this.config.remoteEndpoint,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})}catch(t){console.error("Failed to send log to remote:",t)}}log(e,t,o={}){if(!this.shouldLog(e))return;let n=this.formatMessage(e,t,o);this.logToConsole(n),e>=a.ERROR&&this.logToRemote(n)}debug(e,t={}){this.log(a.DEBUG,e,t)}info(e,t={}){this.log(a.INFO,e,t)}warn(e,t={}){this.log(a.WARN,e,t)}error(e,t={}){t instanceof Error&&(t={error:{message:t.message,stack:t.stack,name:t.name}}),this.log(a.ERROR,e,t)}fatal(e,t={}){t instanceof Error&&(t={error:{message:t.message,stack:t.stack,name:t.name}}),this.log(a.FATAL,e,t)}async time(e,t){let o=performance.now();try{let n=await t(),i=performance.now()-o;return this.debug(`${e} completed`,{duration:`${i.toFixed(2)}ms`}),n}catch(n){let i=performance.now()-o;throw this.error(`${e} failed`,{duration:`${i.toFixed(2)}ms`,error:n}),n}}child(e){return new r(`${this.name}:${e}`,this.config)}},Ae=new g;function M(r){return new g(r)}var _=M("GlobalErrorHandler");window.addEventListener("error",r=>{_.error("Uncaught error",{error:r.error,filename:r.filename,lineno:r.lineno,colno:r.colno}),!(r.filename&&r.filename.includes(".js"))&&F(S.GENERIC)});window.addEventListener("unhandledrejection",r=>{_.error("Unhandled promise rejection",{reason:r.reason,promise:r.promise}),r.preventDefault(),F(S.NETWORK)});function F(r){let e=document.querySelector(".error-banner");e&&e.remove();let t=document.createElement("div");t.className="error-banner",t.innerHTML=`
        <div class="error-content">
            <span class="error-message">${r}</span>
            <button class="error-dismiss" aria-label="Dismiss error">\xD7</button>
        </div>
    `,document.body.insertBefore(t,document.body.firstChild),t.querySelector(".error-dismiss").addEventListener("click",()=>{t.remove()}),setTimeout(()=>{t.parentNode&&t.remove()},c.NOTIFICATION_AUTO_DISMISS)}s.isDevelopment&&_.info("Global error handler initialized");var ye=T.GA_MEASUREMENT_ID;function re(){typeof gtag=="function"||document.querySelector('script[src*="googletagmanager.com"]')}re();return B(oe);})();
