var SAPA_CORE=(()=>{var d=Object.defineProperty;var L=Object.getOwnPropertyDescriptor;var T=Object.getOwnPropertyNames;var A=Object.prototype.hasOwnProperty;var C=(r,e)=>{for(var t in e)d(r,t,{get:e[t],enumerable:!0})},I=(r,e,t,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let o of T(e))!A.call(r,o)&&o!==t&&d(r,o,{get:()=>e[o],enumerable:!(n=L(e,o))||n.enumerable});return r};var W=r=>I(d({},"__esModule",{value:!0}),r);var U={};C(U,{ErrorBoundary:()=>u,addEventListenerWithCleanup:()=>x,cleanupEventListeners:()=>g,debounce:()=>h,globalErrorBoundary:()=>v,initializeTheme:()=>b,registerServiceWorker:()=>E,safeLocalStorageGet:()=>c,safeLocalStorageSet:()=>l,safeQuerySelector:()=>y,throttle:()=>p,toggleTheme:()=>w});function h(r,e){let t;return function(...o){let i=()=>{clearTimeout(t),r(...o)};clearTimeout(t),t=setTimeout(i,e)}}function p(r,e){let t;return function(...o){t||(r.apply(this,o),t=!0,setTimeout(()=>t=!1,e))}}function y(r,e=document){try{return e.querySelector(r)}catch(t){return console.warn(`Failed to query selector "${r}":`,t),null}}function c(r,e=null){try{let t=localStorage.getItem(r);return t!==null?JSON.parse(t):e}catch(t){return console.warn(`Failed to get localStorage item "${r}":`,t),e}}function l(r,e){try{return localStorage.setItem(r,JSON.stringify(e)),!0}catch(t){return console.warn(`Failed to set localStorage item "${r}":`,t),!1}}var u=class{constructor(e={}){this.componentName=e.componentName||"Unknown Component",this.fallbackUI=e.fallbackUI||this.createDefaultFallback(),this.onError=e.onError||this.defaultErrorHandler,this.retryCallback=e.retryCallback||null,this.maxRetries=e.maxRetries||0,this.currentRetries=0,this.container=e.container||null}wrap(e,t=null){return(...n)=>{try{let o=e.apply(t,n);return o&&typeof o.catch=="function"?o.catch(i=>this.handleError(i)):o}catch(o){return this.handleError(o)}}}wrapAsync(e,t=null){return async(...n)=>{try{return await e.apply(t,n)}catch(o){return this.handleError(o)}}}handleError(e){return console.error(`[${this.componentName}] Error caught by boundary:`,e),this.onError(e,this.componentName),this.container&&this.showFallbackUI(e),this.retryCallback&&this.currentRetries<this.maxRetries&&(this.currentRetries++,console.log(`[${this.componentName}] Retrying... (${this.currentRetries}/${this.maxRetries})`),setTimeout(()=>{try{this.retryCallback()}catch(t){console.error(`[${this.componentName}] Retry failed:`,t)}},1e3*this.currentRetries)),null}showFallbackUI(e){if(!this.container)return;let t=typeof this.fallbackUI=="function"?this.fallbackUI(e,this.componentName):this.fallbackUI;if(this.container.innerHTML="",typeof t=="string"?this.container.innerHTML=t:t instanceof HTMLElement&&this.container.appendChild(t),this.retryCallback&&this.currentRetries<this.maxRetries){let n=document.createElement("button");n.textContent="Retry",n.className="btn btn-primary mt-2",n.onclick=()=>{this.container.innerHTML="",this.retryCallback()},this.container.appendChild(n)}}createDefaultFallback(){return(e,t)=>`
            <div class="error-boundary-fallback" style="
                background-color: #f8d7da;
                color: #721c24;
                border: 1px solid #f5c6cb;
                border-radius: 0.375rem;
                padding: 1rem;
                margin: 1rem 0;
                text-align: center;
            ">
                <h4 style="margin-bottom: 0.5rem;">
                    <i class="fas fa-exclamation-triangle"></i>
                    Something went wrong
                </h4>
                <p style="margin-bottom: 0.5rem;">
                    The ${t} component encountered an error and couldn't load properly.
                </p>
                <details style="margin-top: 0.5rem; font-size: 0.875rem;">
                    <summary style="cursor: pointer; color: #495057;">
                        Technical Details
                    </summary>
                    <pre style="
                        background-color: #f8f9fa;
                        padding: 0.5rem;
                        border-radius: 0.25rem;
                        margin-top: 0.5rem;
                        overflow-x: auto;
                        font-size: 0.75rem;
                        text-align: left;
                    ">${e.message}
${e.stack||""}</pre>
                </details>
            </div>
        `}defaultErrorHandler(e,t){console.error(`[ErrorBoundary] ${t}:`,e),typeof gtag<"u"&&gtag("event","exception",{description:`${t}: ${e.message}`,fatal:!1});try{let n=JSON.parse(localStorage.getItem("errorBoundaryLog")||"[]");n.push({timestamp:new Date().toISOString(),component:t,message:e.message,stack:e.stack,userAgent:navigator.userAgent}),n.length>50&&n.splice(0,n.length-50),localStorage.setItem("errorBoundaryLog",JSON.stringify(n))}catch(n){console.warn("Failed to log error to localStorage:",n)}}reset(){this.currentRetries=0}},m=class{constructor(){this.setupGlobalHandlers(),this.errorCount=0,this.maxErrors=10,this.timeWindow=6e4,this.errorTimes=[]}setupGlobalHandlers(){window.addEventListener("error",e=>{this.handleGlobalError(e.error,e.filename,e.lineno,e.colno)}),window.addEventListener("unhandledrejection",e=>{this.handleGlobalError(e.reason,"Promise rejection",0,0),e.preventDefault()})}handleGlobalError(e,t,n,o){let i=Date.now();if(this.errorTimes=this.errorTimes.filter(S=>i-S<this.timeWindow),this.errorTimes.length>=this.maxErrors){console.warn("Too many errors detected. Stopping error boundary logging to prevent spam.");return}this.errorTimes.push(i);let s={message:e?.message||e||"Unknown error",source:t||"Unknown source",line:n||0,column:o||0,stack:e?.stack||"",timestamp:new Date().toISOString(),userAgent:navigator.userAgent,url:window.location.href};console.error("[GlobalErrorBoundary] Uncaught error:",s),typeof gtag<"u"&&gtag("event","exception",{description:`Global: ${s.message}`,fatal:!1}),this.showErrorNotification(s)}showErrorNotification(e){let t=document.getElementById("global-error-notification");t||(t=document.createElement("div"),t.id="global-error-notification",t.style.cssText=`
                position: fixed;
                top: 20px;
                right: 20px;
                background-color: #f8d7da;
                color: #721c24;
                border: 1px solid #f5c6cb;
                border-radius: 0.375rem;
                padding: 1rem;
                max-width: 300px;
                z-index: 9999;
                box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
                display: none;
            `,t.innerHTML=`
                <div style="display: flex; align-items: center; justify-content: space-between;">
                    <span style="font-weight: bold;">
                        <i class="fas fa-exclamation-triangle"></i>
                        Something went wrong
                    </span>
                    <button id="close-error-notification" style="
                        background: none;
                        border: none;
                        font-size: 1.2rem;
                        cursor: pointer;
                        color: #721c24;
                        padding: 0;
                        margin-left: 0.5rem;
                    ">&times;</button>
                </div>
                <p style="margin: 0.5rem 0 0 0; font-size: 0.875rem;">
                    We've encountered an unexpected error. The page may not work correctly.
                    Please refresh to try again.
                </p>
            `,document.body.appendChild(t),document.getElementById("close-error-notification").onclick=()=>{t.style.display="none"},setTimeout(()=>{t&&(t.style.display="none")},1e4)),t.style.display="block"}},v=new m;function b(){let r=c("theme","light");f(r),window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",N)}function w(){let e=F()==="dark"?"light":"dark";return f(e),l("theme",e),e}function F(){return document.documentElement.getAttribute("data-theme")||"light"}function f(r){document.documentElement.setAttribute("data-theme",r);let e=document.querySelector('meta[name="theme-color"]');e&&e.setAttribute("content",r==="dark"?"#1a1a1a":"#ffffff"),window.dispatchEvent(new CustomEvent("themechange",{detail:{theme:r}}))}function N(r){if(!c("theme")){let t=r.matches?"dark":"light";f(t)}}async function E(){if("serviceWorker"in navigator)try{console.log("Registering service worker...");let r=await navigator.serviceWorker.register("/sw.js",{scope:"/"});return console.log("Service worker registered successfully:",r),r.addEventListener("updatefound",()=>{let e=r.installing;e&&e.addEventListener("statechange",()=>{e.state==="installed"&&navigator.serviceWorker.controller&&R()})}),r}catch(r){return console.warn("Service worker registration failed:",r),null}else return console.log("Service worker not supported"),null}function R(){let r=document.createElement("div");r.className="update-notification",r.innerHTML=`
        <div class="update-content">
            <p>A new version of the site is available!</p>
            <button class="btn-update">Update Now</button>
            <button class="btn-dismiss">Dismiss</button>
        </div>
    `,document.body.appendChild(r),r.querySelector(".btn-update").addEventListener("click",()=>{window.location.reload()}),r.querySelector(".btn-dismiss").addEventListener("click",()=>{r.remove()}),setTimeout(()=>{r.parentNode&&r.remove()},1e4)}var a=new Map;function x(r,e,t,n){if(!r||typeof r.addEventListener!="function"){console.warn("Invalid element provided to addEventListenerWithCleanup");return}r.addEventListener(e,t,n),a.has(r)||a.set(r,[]),a.get(r).push({event:e,handler:t,options:n})}function g(r=null){if(r){let e=a.get(r);e&&(e.forEach(({event:t,handler:n,options:o})=>{r.removeEventListener(t,n,o)}),a.delete(r))}else a.forEach((e,t)=>{e.forEach(({event:n,handler:o,options:i})=>{try{t.removeEventListener(n,o,i)}catch(s){console.warn("Failed to remove event listener:",s)}})}),a.clear()}typeof window<"u"&&window.addEventListener("beforeunload",()=>{g()});window.addEventListener("error",r=>{console.error("Uncaught error:",r.error),!(r.filename&&r.filename.includes(".js"))&&k("An unexpected error occurred. Please refresh the page.")});window.addEventListener("unhandledrejection",r=>{console.error("Unhandled promise rejection:",r.reason),r.preventDefault(),k("A network or processing error occurred. Please try again.")});function k(r){let e=document.querySelector(".error-banner");e&&e.remove();let t=document.createElement("div");t.className="error-banner",t.innerHTML=`
        <div class="error-content">
            <span class="error-message">${r}</span>
            <button class="error-dismiss" aria-label="Dismiss error">\xD7</button>
        </div>
    `,document.body.insertBefore(t,document.body.firstChild),t.querySelector(".error-dismiss").addEventListener("click",()=>{t.remove()}),setTimeout(()=>{t.parentNode&&t.remove()},1e4)}function $(){if(typeof gtag=="function"){console.log("Google Analytics already initialized");return}if(!document.querySelector('script[src*="googletagmanager.com"]')){console.log("Google Analytics not configured");return}console.log("Google Analytics initialized via HTML script tags")}$();return W(U);})();
