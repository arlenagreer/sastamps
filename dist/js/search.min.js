var SAPASearch=(()=>{var b=Object.defineProperty;var S=Object.getOwnPropertyDescriptor;var x=Object.getOwnPropertyNames;var L=Object.prototype.hasOwnProperty;var k=(p,e)=>{for(var t in e)b(p,t,{get:e[t],enumerable:!0})},q=(p,e,t,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let a of x(e))!L.call(p,a)&&a!==t&&b(p,a,{get:()=>e[a],enumerable:!(r=S(e,a))||r.enumerable});return p};var E=p=>q(b({},"__esModule",{value:!0}),p);var $={};k($,{default:()=>T});var v=class{constructor(e={}){this.index=null,this.documents=new Map,this.isLoaded=!1,this.isLoading=!1,this.baseUrl=e.baseUrl||"./dist/data",this.lunrUrl=e.lunrUrl||"https://unpkg.com/lunr@2.3.9/lunr.min.js",this.callbacks={onLoad:e.onLoad||(()=>{}),onSearch:e.onSearch||(()=>{}),onError:e.onError||(t=>console.error("Search error:",t))},this.ensureLunrLoaded()}async ensureLunrLoaded(){return typeof lunr<"u"?Promise.resolve():new Promise((e,t)=>{let r=document.createElement("script");r.src=this.lunrUrl,r.onload=()=>e(),r.onerror=()=>t(new Error("Failed to load Lunr.js")),document.head.appendChild(r)})}async initialize(){if(!(this.isLoaded||this.isLoading)){this.isLoading=!0;try{await this.ensureLunrLoaded(),await this.ensureLunrLoaded();let[e,t]=await Promise.all([this.loadSearchIndex(),this.loadSearchDocuments()]);this.index=lunr.Index.load(e),this.buildDocumentsMap(t.documents),this.isLoaded=!0,this.isLoading=!1,this.callbacks.onLoad(t.metadata)}catch(e){throw this.isLoading=!1,console.error("\u274C Failed to initialize search engine:",e),this.callbacks.onError(e),e}}}async loadSearchIndex(){let e=await fetch(`${this.baseUrl}/search-index.json`);if(!e.ok)throw new Error(`Failed to load search index: ${e.statusText}`);return e.json()}async loadSearchDocuments(){let e=await fetch(`${this.baseUrl}/search-documents.json`);if(!e.ok)throw new Error(`Failed to load search documents: ${e.statusText}`);return e.json()}buildDocumentsMap(e){this.documents.clear(),e.forEach(t=>{this.documents.set(t.id,t)})}async search(e,t={}){this.isLoaded||await this.initialize();let{limit:r=50,types:a=[],categories:i=[],difficulty:s=[],boost:n=!0}=t;try{let u=this.index.search(e).map(l=>{let c=this.documents.get(l.ref);return{id:l.ref,score:l.score,document:c,matches:l.matchData||{}}});u=this.applyFilters(u,{types:a,categories:i,difficulty:s}),r>0&&(u=u.slice(0,r));let f={query:e,results:u,total:u.length,hasResults:u.length>0,metadata:{searchTime:Date.now(),totalDocuments:this.documents.size,appliedFilters:{types:a,categories:i,difficulty:s}}};return this.callbacks.onSearch(f),f}catch(d){return console.error("Search error:",d),this.callbacks.onError(d),{query:e,results:[],total:0,hasResults:!1,error:d.message}}}applyFilters(e,t){let{types:r,categories:a,difficulty:i,dateRange:s,tags:n,years:d,quarters:u}=t;return e.filter(f=>{let l=f.document;if(!l||r&&r.length>0&&!r.includes(l.type)||a&&a.length>0&&!a.includes(l.category)||i&&i.length>0&&l.difficulty&&!i.includes(l.difficulty))return!1;if(s&&s.from&&s.to&&l.date){let c=new Date(l.date),m=new Date(s.from),y=new Date(s.to);if(c<m||c>y)return!1}if(n&&n.length>0&&l.tags&&!n.some(m=>l.tags.includes(m)))return!1;if(d&&d.length>0&&l.date){let c=new Date(l.date).getFullYear();if(!d.includes(c.toString()))return!1}return!(u&&u.length>0&&l.quarter&&!u.includes(l.quarter))})}async getSuggestions(e,t=5){if(!this.isLoaded||!e||e.length<2)return[];try{let r=`${e}*`;return(await this.search(r,{limit:t})).results.map(i=>({text:i.document.title,type:i.document.type,url:i.document.url}))}catch(r){return console.error("Suggestions error:",r),[]}}getFilterOptions(){if(!this.isLoaded)return{types:[],categories:[],difficulty:[],years:[],quarters:[],tags:[]};let e={types:new Set,categories:new Set,difficulty:new Set,years:new Set,quarters:new Set,tags:new Set};return this.documents.forEach(t=>{if(t.type&&e.types.add(t.type),t.category&&e.categories.add(t.category),t.difficulty&&e.difficulty.add(t.difficulty),t.quarter&&e.quarters.add(t.quarter),t.date){let r=new Date(t.date).getFullYear();e.years.add(r.toString())}t.tags&&Array.isArray(t.tags)&&t.tags.forEach(r=>e.tags.add(r))}),{types:Array.from(e.types).sort(),categories:Array.from(e.categories).sort(),difficulty:Array.from(e.difficulty).sort(),years:Array.from(e.years).sort().reverse(),quarters:["First","Second","Third","Fourth"],tags:Array.from(e.tags).sort()}}createSearchUI(e,t={}){let{placeholder:r="Search newsletters, meetings, resources...",showFilters:a=!0,showSuggestions:i=!0,autoSearch:s=!0,searchDelay:n=300}=t;if(typeof e=="string"&&(e=document.querySelector(e)),!e)throw new Error("Search container not found");return e.innerHTML=this.generateSearchHTML(r,a),this.initializeSearchUI(e,{showSuggestions:i,autoSearch:s,searchDelay:n}),e}generateSearchHTML(e,t){return`
            <div class="search-container">
                <div class="search-input-wrapper">
                    <input type="search" 
                           class="search-input" 
                           placeholder="${e}"
                           autocomplete="off"
                           spellcheck="false">
                    <button class="search-button" type="button">
                        <i class="fas fa-search"></i>
                    </button>
                    <div class="search-suggestions" style="display: none;"></div>
                </div>
                
                ${t?`
                    <div class="search-filters">
                        <div class="filter-row">
                            <div class="filter-group">
                                <label>Type:</label>
                                <select class="filter-select" data-filter="type">
                                    <option value="">All Types</option>
                                </select>
                            </div>
                            <div class="filter-group">
                                <label>Year:</label>
                                <select class="filter-select" data-filter="year">
                                    <option value="">All Years</option>
                                </select>
                            </div>
                            <div class="filter-group">
                                <label>Quarter:</label>
                                <select class="filter-select" data-filter="quarter">
                                    <option value="">All Quarters</option>
                                </select>
                            </div>
                        </div>
                        <div class="filter-row">
                            <div class="filter-group">
                                <label>Date From:</label>
                                <input type="date" class="filter-input" data-filter="date-from">
                            </div>
                            <div class="filter-group">
                                <label>Date To:</label>
                                <input type="date" class="filter-input" data-filter="date-to">
                            </div>
                            <div class="filter-group">
                                <label>Tags:</label>
                                <select class="filter-select" data-filter="tags" multiple>
                                </select>
                            </div>
                        </div>
                        <div class="filter-actions">
                            <button class="clear-filters-button" type="button">
                                <i class="fas fa-times"></i> Clear Filters
                            </button>
                            <button class="toggle-filters-button" type="button">
                                <i class="fas fa-chevron-up"></i> Hide Filters
                            </button>
                        </div>
                    </div>
                `:""}
                
                <div class="search-results">
                    <div class="search-status"></div>
                    <div class="search-results-list"></div>
                </div>
            </div>
        `}async initializeSearchUI(e,t){let{showSuggestions:r,autoSearch:a,searchDelay:i}=t,s=e.querySelector(".search-input"),n=e.querySelector(".search-button"),d=e.querySelector(".search-suggestions"),u=e.querySelector(".search-results-list"),f=e.querySelector(".search-status"),l=e.querySelectorAll(".filter-select"),c=e.querySelectorAll(".filter-input"),m=e.querySelector(".clear-filters-button"),y=e.querySelector(".toggle-filters-button"),w,g="";await this.initialize(),this.populateFilterOptions(l),s.addEventListener("input",o=>{let h=o.target.value.trim();g=h,a&&(clearTimeout(w),w=setTimeout(()=>{h?this.performUISearch(h,e):this.clearResults(e)},i)),r&&h.length>=2?this.showSuggestions(h,d,s):d.style.display="none"}),n.addEventListener("click",()=>{let o=s.value.trim();o&&this.performUISearch(o,e)}),s.addEventListener("keydown",o=>{if(o.key==="Enter"){o.preventDefault();let h=s.value.trim();h&&this.performUISearch(h,e)}}),l.forEach(o=>{o.addEventListener("change",()=>{g&&this.performUISearch(g,e)})}),c.forEach(o=>{o.addEventListener("change",()=>{g&&this.performUISearch(g,e)})}),m&&m.addEventListener("click",()=>{l.forEach(o=>{o.hasAttribute("multiple")?Array.from(o.options).forEach(h=>h.selected=!1):o.value=""}),c.forEach(o=>o.value=""),g&&this.performUISearch(g,e)}),y&&y.addEventListener("click",()=>{let o=e.querySelector(".search-filters");o.classList.contains("collapsed")?(o.classList.remove("collapsed"),y.innerHTML='<i class="fas fa-chevron-up"></i> Hide Filters'):(o.classList.add("collapsed"),y.innerHTML='<i class="fas fa-chevron-down"></i> Show Filters')}),document.addEventListener("click",o=>{e.contains(o.target)||(d.style.display="none")})}populateFilterOptions(e){let t=this.getFilterOptions();e.forEach(r=>{let a=r.dataset.filter,i=[];switch(a){case"type":i=t.types.map(s=>({value:s,label:this.formatLabel(s)}));break;case"category":i=t.categories.map(s=>({value:s,label:this.formatLabel(s)}));break;case"difficulty":i=t.difficulty.map(s=>({value:s,label:this.formatLabel(s)}));break;case"year":i=t.years.map(s=>({value:s,label:s}));break;case"quarter":i=t.quarters.map(s=>({value:s,label:s}));break;case"tags":i=t.tags.map(s=>({value:s,label:this.formatLabel(s)}));break}i.forEach(s=>{let n=document.createElement("option");n.value=s.value,n.textContent=s.label,r.appendChild(n)})})}formatLabel(e){return e.replace(/-/g," ").replace(/\b\w/g,t=>t.toUpperCase())}async performUISearch(e,t){let r=t.querySelector(".search-results-list"),a=t.querySelector(".search-status"),i=t.querySelectorAll(".filter-select"),s=t.querySelectorAll(".filter-input");a.innerHTML='<div class="search-loading">Searching...</div>',r.innerHTML="";let n={};i.forEach(f=>{let l=f.dataset.filter;if(f.hasAttribute("multiple")){let c=Array.from(f.selectedOptions).map(m=>m.value);c.length>0&&(n[l]=c)}else{let c=f.value;c&&(l==="type"?n.types=[c]:l==="category"?n.categories=[c]:l==="difficulty"?n.difficulty=[c]:l==="year"?n.years=[c]:l==="quarter"&&(n.quarters=[c]))}});let d=t.querySelector('[data-filter="date-from"]')?.value,u=t.querySelector('[data-filter="date-to"]')?.value;(d||u)&&(n.dateRange={from:d||"1900-01-01",to:u||"2099-12-31"});try{let f=await this.search(e,n);this.displaySearchResults(f,t)}catch(f){a.innerHTML=`<div class="search-error">Search failed: ${f.message}</div>`}}displaySearchResults(e,t){let r=t.querySelector(".search-results-list"),a=t.querySelector(".search-status");e.hasResults?a.innerHTML=`
                <div class="search-info">
                    Found ${e.total} result${e.total===1?"":"s"} for "${e.query}"
                </div>
            `:a.innerHTML=`
                <div class="search-no-results">
                    No results found for "${e.query}"
                </div>
            `,e.hasResults?r.innerHTML=e.results.map(i=>this.renderSearchResult(i)).join(""):r.innerHTML=""}renderSearchResult(e){let t=e.document,r=this.getTypeIcon(t.type),a=t.date?new Date(t.date).toLocaleDateString():"";return`
            <div class="search-result-item" data-type="${t.type}">
                <div class="search-result-header">
                    <h3 class="search-result-title">
                        <i class="${r}"></i>
                        <a href="${t.url}">${t.title}</a>
                    </h3>
                    <div class="search-result-meta">
                        <span class="search-result-type">${this.formatLabel(t.type)}</span>
                        ${t.category?`<span class="search-result-category">${this.formatLabel(t.category)}</span>`:""}
                        ${t.difficulty?`<span class="search-result-difficulty difficulty-${t.difficulty}">${t.difficulty}</span>`:""}
                        ${a?`<span class="search-result-date">${a}</span>`:""}
                    </div>
                </div>
                <p class="search-result-summary">${t.summary}</p>
                ${t.tags&&t.tags.length>0?`
                    <div class="search-result-tags">
                        ${t.tags.map(i=>`<span class="tag">${i}</span>`).join("")}
                    </div>
                `:""}
                <div class="search-result-score">Relevance: ${(e.score*100).toFixed(1)}%</div>
            </div>
        `}getTypeIcon(e){return{newsletter:"fas fa-newspaper",meeting:"fas fa-calendar",resource:"fas fa-book",glossary:"fas fa-book-open"}[e]||"fas fa-file"}async showSuggestions(e,t,r){try{let a=await this.getSuggestions(e);a.length>0?(t.innerHTML=a.map(i=>`
                    <div class="search-suggestion" data-url="${i.url}">
                        <i class="${this.getTypeIcon(i.type)}"></i>
                        <span>${i.text}</span>
                    </div>
                `).join(""),t.querySelectorAll(".search-suggestion").forEach(i=>{i.addEventListener("click",s=>{s.preventDefault(),r.value=i.querySelector("span").textContent,t.style.display="none",this.performUISearch(r.value,r.closest(".search-container"))})}),t.style.display="block"):t.style.display="none"}catch(a){console.error("Suggestions error:",a),t.style.display="none"}}clearResults(e){let t=e.querySelector(".search-results-list"),r=e.querySelector(".search-status"),a=e.querySelector(".search-suggestions");t&&(t.innerHTML=""),r&&(r.innerHTML=""),a&&(a.style.display="none")}static addStyles(){if(document.getElementById("search-engine-styles"))return;let e=`
            .search-container {
                margin: 2rem 0;
                font-family: var(--font-body, Arial, sans-serif);
            }

            .search-input-wrapper {
                position: relative;
                margin-bottom: 1rem;
            }

            .search-input {
                width: 100%;
                padding: 1rem 3rem 1rem 1rem;
                border: 2px solid var(--light, #ecf0f1);
                border-radius: var(--radius-md, 5px);
                font-size: 1rem;
                transition: border-color var(--transition-fast, 0.15s ease);
                box-sizing: border-box;
            }

            .search-input:focus {
                outline: none;
                border-color: var(--primary, #1a5276);
            }

            .search-button {
                position: absolute;
                right: 0.5rem;
                top: 50%;
                transform: translateY(-50%);
                background: none;
                border: none;
                color: var(--medium, #7f8c8d);
                font-size: 1.2rem;
                cursor: pointer;
                padding: 0.5rem;
                border-radius: var(--radius-sm, 3px);
                transition: color var(--transition-fast, 0.15s ease);
            }

            .search-button:hover {
                color: var(--primary, #1a5276);
            }

            .search-suggestions {
                position: absolute;
                top: 100%;
                left: 0;
                right: 0;
                background: var(--white, #fff);
                border: 1px solid var(--light, #ecf0f1);
                border-top: none;
                border-radius: 0 0 var(--radius-md, 5px) var(--radius-md, 5px);
                box-shadow: var(--shadow-lg, 0 10px 15px -3px rgba(0,0,0,0.1));
                z-index: 1000;
                max-height: 300px;
                overflow-y: auto;
            }

            .search-suggestion {
                padding: 0.75rem 1rem;
                cursor: pointer;
                display: flex;
                align-items: center;
                gap: 0.5rem;
                transition: background-color var(--transition-fast, 0.15s ease);
            }

            .search-suggestion:hover {
                background-color: var(--light, #ecf0f1);
            }

            .search-suggestion i {
                color: var(--primary, #1a5276);
                width: 1rem;
            }

            .search-filters {
                margin-bottom: 1rem;
                background-color: var(--light, #ecf0f1);
                border-radius: var(--radius-md, 5px);
                border: 1px solid #ddd;
                transition: all var(--transition-normal, 0.25s ease);
            }

            .search-filters.collapsed .filter-row {
                display: none;
            }

            .filter-row {
                display: flex;
                flex-wrap: wrap;
                gap: 1rem;
                padding: 1rem;
                align-items: center;
            }

            .filter-actions {
                padding: 0.5rem 1rem;
                border-top: 1px solid #ddd;
                background-color: #f8f9fa;
                display: flex;
                justify-content: space-between;
                align-items: center;
            }

            .filter-group {
                display: flex;
                align-items: center;
                gap: 0.5rem;
            }

            .filter-group label {
                font-weight: 600;
                color: var(--dark, #2c3e50);
                white-space: nowrap;
            }

            .filter-select,
            .filter-input {
                padding: 0.5rem;
                border: 1px solid var(--medium, #7f8c8d);
                border-radius: var(--radius-sm, 3px);
                background-color: var(--white, #fff);
                font-size: 0.9rem;
                min-width: 120px;
            }

            .filter-select[multiple] {
                min-height: 100px;
                min-width: 160px;
            }

            .filter-input[type="date"] {
                min-width: 140px;
            }

            .clear-filters-button,
            .toggle-filters-button {
                padding: 0.5rem 1rem;
                border: none;
                border-radius: var(--radius-sm, 3px);
                cursor: pointer;
                font-size: 0.9rem;
                transition: all var(--transition-fast, 0.15s ease);
                display: flex;
                align-items: center;
                gap: 0.5rem;
            }

            .clear-filters-button {
                background-color: var(--warning, #f39c12);
                color: var(--white, #fff);
            }

            .clear-filters-button:hover {
                background-color: #e67e22;
            }

            .toggle-filters-button {
                background-color: var(--primary, #1a5276);
                color: var(--white, #fff);
            }

            .toggle-filters-button:hover {
                background-color: var(--primary-light, #2980b9);
            }

            .search-results {
                margin-top: 1rem;
            }

            .search-info,
            .search-no-results,
            .search-error,
            .search-loading {
                padding: 1rem;
                margin-bottom: 1rem;
                border-radius: var(--radius-md, 5px);
                font-weight: 600;
            }

            .search-info {
                background-color: #e8f4f8;
                color: var(--primary, #1a5276);
                border-left: 4px solid var(--primary, #1a5276);
            }

            .search-no-results {
                background-color: #fff3cd;
                color: #856404;
                border-left: 4px solid #ffc107;
            }

            .search-error {
                background-color: #f8d7da;
                color: #721c24;
                border-left: 4px solid #dc3545;
            }

            .search-loading {
                background-color: var(--light, #ecf0f1);
                color: var(--medium, #7f8c8d);
                text-align: center;
            }

            .search-result-item {
                background-color: var(--white, #fff);
                border: 1px solid var(--light, #ecf0f1);
                border-radius: var(--radius-md, 5px);
                padding: 1.5rem;
                margin-bottom: 1rem;
                transition: box-shadow var(--transition-fast, 0.15s ease);
            }

            .search-result-item:hover {
                box-shadow: var(--shadow-md, 0 4px 6px rgba(0,0,0,0.1));
            }

            .search-result-header {
                margin-bottom: 1rem;
            }

            .search-result-title {
                margin: 0 0 0.5rem 0;
                font-size: 1.25rem;
            }

            .search-result-title a {
                color: var(--primary, #1a5276);
                text-decoration: none;
                margin-left: 0.5rem;
            }

            .search-result-title a:hover {
                text-decoration: underline;
            }

            .search-result-title i {
                color: var(--secondary, #d35400);
            }

            .search-result-meta {
                display: flex;
                flex-wrap: wrap;
                gap: 0.5rem;
                font-size: 0.9rem;
            }

            .search-result-type,
            .search-result-category,
            .search-result-difficulty,
            .search-result-date {
                padding: 0.25rem 0.5rem;
                border-radius: var(--radius-sm, 3px);
                background-color: var(--light, #ecf0f1);
                color: var(--dark, #2c3e50);
            }

            .search-result-difficulty.difficulty-beginner {
                background-color: #27ae60;
                color: var(--white, #fff);
            }

            .search-result-difficulty.difficulty-intermediate {
                background-color: #f39c12;
                color: var(--white, #fff);
            }

            .search-result-difficulty.difficulty-advanced {
                background-color: #c0392b;
                color: var(--white, #fff);
            }

            .search-result-summary {
                margin: 1rem 0;
                color: var(--medium, #7f8c8d);
                line-height: 1.6;
            }

            .search-result-tags {
                margin: 1rem 0;
            }

            .search-result-tags .tag {
                display: inline-block;
                padding: 0.25rem 0.5rem;
                margin: 0.125rem;
                background-color: var(--accent, #f1c40f);
                color: var(--dark, #2c3e50);
                border-radius: var(--radius-sm, 3px);
                font-size: 0.8rem;
            }

            .search-result-score {
                font-size: 0.8rem;
                color: var(--medium, #7f8c8d);
                text-align: right;
                margin-top: 0.5rem;
            }

            /* Mobile responsive */
            @media (max-width: 768px) {
                .filter-row {
                    flex-direction: column;
                    align-items: stretch;
                    gap: 0.75rem;
                }

                .filter-group {
                    justify-content: space-between;
                }

                .filter-actions {
                    flex-direction: column;
                    gap: 0.5rem;
                }

                .filter-select,
                .filter-input {
                    min-width: auto;
                    width: 100%;
                }

                .search-result-meta {
                    flex-direction: column;
                    gap: 0.25rem;
                }
            }

            @media (max-width: 576px) {
                .filter-row {
                    padding: 0.75rem;
                }
                
                .filter-actions {
                    padding: 0.75rem;
                }
                
                .clear-filters-button,
                .toggle-filters-button {
                    width: 100%;
                    justify-content: center;
                }
            }
        `,t=document.createElement("style");t.id="search-engine-styles",t.textContent=e,document.head.appendChild(t)}};typeof document<"u"&&(document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>v.addStyles()):v.addStyles());var T=v;typeof window<"u"&&(window.SearchEngine=v);return E($);})();
