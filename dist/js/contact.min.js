var SAPA_CONTACT=(()=>{var V=Object.defineProperty,Ee=Object.defineProperties;var fe=Object.getOwnPropertyDescriptors;var w=Object.getOwnPropertySymbols;var X=Object.prototype.hasOwnProperty,$=Object.prototype.propertyIsEnumerable;var B=(r,e,t)=>e in r?V(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,l=(r,e)=>{for(var t in e||(e={}))X.call(e,t)&&B(r,t,e[t]);if(w)for(var t of w(e))$.call(e,t)&&B(r,t,e[t]);return r},d=(r,e)=>Ee(r,fe(e));var q=(r,e)=>{var t={};for(var o in r)X.call(r,o)&&e.indexOf(o)<0&&(t[o]=r[o]);if(r!=null&&w)for(var o of w(r))e.indexOf(o)<0&&$.call(r,o)&&(t[o]=r[o]);return t};var A=(r,e)=>()=>(r&&(e=r(r=0)),e);var de=(r,e)=>{for(var t in e)V(r,t,{get:e[t],enumerable:!0})};var D,F,M,p,K,me,v,O,R=A(()=>{D={DEBOUNCE_DEFAULT:500,DEBOUNCE_SEARCH:300,THROTTLE_DEFAULT:1e3,ANIMATION_FRAME_FALLBACK:16,NOTIFICATION_AUTO_DISMISS:1e4,NOTIFICATION_SHORT:2e3,REMINDER_CHECK_INTERVAL:6e4,REMINDER_AUTO_DISMISS:15e3,COPY_FEEDBACK_DURATION:1500,FORM_MESSAGE_SUCCESS_DURATION:1e4,RSVP_CONFIRMATION_DURATION:3e3,RETRY_DELAY_BASE:1e3,SERVICE_WORKER_UPDATE_DISMISS:1e4},F={CONTACT_FORM:"/contact-handler.php",CSRF_TOKEN:"/csrf-token.php",NETLIFY_CONTACT:"/.netlify/functions/contact-form",NEWSLETTER_ARCHIVE:"/api/newsletters",MEETING_DATA:"/data/meetings/meetings.json"},M={ERROR:"error",SUCCESS:"success",WARNING:"warning",LOADING:"loading",DISABLED:"disabled",ACTIVE:"active",HIDDEN:"hidden",VISIBLE:"visible"},p={GENERIC:"An error occurred. Please try again.",NETWORK:"Network error. Please check your connection.",VALIDATION_FAILED:"Please correct the errors above before submitting.",LOAD_FAILED:"Failed to load content. Please try again.",SUBMISSION_FAILED:"Sorry, there was an error sending your message. Please try again.",CALENDAR_UNAVAILABLE:"Calendar temporarily unavailable. Please try refreshing the page.",MEETING_LOAD_FAILED:"Unable to load meetings. Please try again later.",REMINDER_PERMISSION_DENIED:"Notification permission was denied.",COPY_FAILED:"Failed to copy to clipboard."},K={FORM_SUBMITTED:"Thank you! Your message has been sent successfully.",SETTINGS_SAVED:"Settings have been saved successfully.",REMINDER_SET:"Reminder has been set.",COPIED_TO_CLIPBOARD:"Copied to clipboard!",RSVP_CONFIRMED:"Thanks for your RSVP!",RSVP_CANCELLED:"RSVP cancelled"},me={GA_MEASUREMENT_ID:"G-XXXXXXXXXX",EVENTS:{PAGE_VIEW:"page_view",FORM_SUBMIT:"form_submit",FILE_DOWNLOAD:"file_download",NEWSLETTER_DOWNLOAD:"newsletter_download",MEETING_RSVP:"meeting_rsvp",SEARCH:"search",RESOURCE_VIEW:"resource_view"}},v=d(l({},me.EVENTS),{CONTACT_FORM_SUBMIT:"contact_form_submit",SEARCH_PERFORMED:"search_performed",REMINDER_SET:"reminder_set"}),O={PAGE_SIZE:10,MAX_SEARCH_RESULTS:50,IMAGE_QUALITY:.85,COMPRESSION_LEVEL:9,CACHE_DURATION:3600,SESSION_TIMEOUT:1800}});var u,j,pe,Te,Se,ge,Re,he,Ne,Ae,Oe,P,Ie,z=A(()=>{R();u={isDevelopment:window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1",isProduction:window.location.protocol==="https:",isDebug:window.location.search.includes("debug=true")},j={enableReminders:!0,enableAnalytics:u.isProduction,enableServiceWorker:u.isProduction,enableDebugLogging:u.isDevelopment||u.isDebug,enableCaching:!0,enableOfflineMode:!0},pe={baseURL:u.isDevelopment?"http://localhost:3000":"",timeout:3e4,retries:3,cacheTimeout:O.CACHE_DURATION*1e3},Te={prefix:"sapa_",version:"1.0",maxAge:O.SESSION_TIMEOUT*1e3},Se={formats:["webp","jpg"],sizes:[320,640,960,1280,1920],quality:O.IMAGE_QUALITY,lazyLoadOffset:50},ge={minSearchLength:2,maxResults:O.MAX_SEARCH_RESULTS,debounceDelay:300,highlightMatches:!0},Re={autoSave:!0,autoSaveInterval:3e4,maxRetries:3,showProgressIndicator:!0},he={defaultView:"month",firstDayOfWeek:0,showWeekNumbers:!1,allowPastDates:!1,maxFutureMonths:12},Ne={position:"top-right",duration:5e3,maxNotifications:3,soundEnabled:!1},Ae={enableLazyLoading:!0,enableCodeSplitting:!0,enablePrefetch:u.isProduction,enableCompression:u.isProduction,reportWebVitals:u.isProduction},Oe={enableCSRF:!0,enableRateLimit:!0,rateLimitMax:3,rateLimitWindow:36e5,allowedOrigins:["https://sastamps.org","https://www.sastamps.org"]},P={level:u.isDevelopment?"debug":"error",enableConsole:!0,enableRemote:u.isProduction,remoteEndpoint:"/api/logs"},Ie={env:u,features:j,api:pe,storage:Te,image:Se,search:ge,form:Re,calendar:he,notification:Ne,performance:Ae,security:Oe,logging:P};Object.freeze(Ie);Object.freeze(u);Object.freeze(j)});function f(r){return new x(r)}var s,h,x,Qe,S=A(()=>{z();s={DEBUG:0,INFO:1,WARN:2,ERROR:3,FATAL:4},h={[s.DEBUG]:"DEBUG",[s.INFO]:"INFO",[s.WARN]:"WARN",[s.ERROR]:"ERROR",[s.FATAL]:"FATAL"},x=class r{constructor(e="App",t=P){this.name=e,this.config=t,this.level=this.parseLevel(t.level)}parseLevel(e){return{debug:s.DEBUG,info:s.INFO,warn:s.WARN,error:s.ERROR,fatal:s.FATAL}[e.toLowerCase()]||s.INFO}shouldLog(e){return e>=this.level}formatMessage(e,t,o={}){return d(l({timestamp:new Date().toISOString(),level:h[e],logger:this.name,message:t},o),{url:window.location.href,userAgent:navigator.userAgent})}logToConsole(e){if(!this.config.enableConsole)return;let i=e,{level:t,message:o}=i,n=q(i,["level","message"]),a=`[${e.timestamp}] [${t}] [${this.name}]`;switch(t){case h[s.DEBUG]:console.debug(a,o,n);break;case h[s.INFO]:console.info(a,o,n);break;case h[s.WARN]:console.warn(a,o,n);break;case h[s.ERROR]:case h[s.FATAL]:console.error(a,o,n);break}}async logToRemote(e){if(!(!this.config.enableRemote||!u.isProduction))try{await fetch(this.config.remoteEndpoint,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})}catch(t){console.error("Failed to send log to remote:",t)}}log(e,t,o={}){if(!this.shouldLog(e))return;let n=this.formatMessage(e,t,o);this.logToConsole(n),e>=s.ERROR&&this.logToRemote(n)}debug(e,t={}){this.log(s.DEBUG,e,t)}info(e,t={}){this.log(s.INFO,e,t)}warn(e,t={}){this.log(s.WARN,e,t)}error(e,t={}){t instanceof Error&&(t={error:{message:t.message,stack:t.stack,name:t.name}}),this.log(s.ERROR,e,t)}fatal(e,t={}){t instanceof Error&&(t={error:{message:t.message,stack:t.stack,name:t.name}}),this.log(s.FATAL,e,t)}async time(e,t){let o=performance.now();try{let n=await t(),a=performance.now()-o;return this.debug(`${e} completed`,{duration:`${a.toFixed(2)}ms`}),n}catch(n){let a=performance.now()-o;throw this.error(`${e} failed`,{duration:`${a.toFixed(2)}ms`,error:n}),n}}child(e){return new r(`${this.name}:${e}`,this.config)}},Qe=new x});function G(r,e={}){let{onError:t=null,fallbackValue:o=null,logError:n=!0,trackError:a=!0,errorMessage:i=p.GENERIC}=e;return async function(...E){try{return await r.apply(this,E)}catch(c){if(n&&ye.error(`Error in ${r.name||"anonymous function"}:`,c),a&&typeof gtag=="function"&&gtag("event","exception",{description:c.message,fatal:!1,error_type:c.type||m.UNKNOWN}),t)return t(c);if(o!==null)return o;throw new T(i,c.type||m.UNKNOWN,{originalError:c})}}}async function ee(r,e={}){let{maxRetries:t=3,initialDelay:o=1e3,maxDelay:n=1e4,backoffFactor:a=2,shouldRetry:i=c=>!0}=e,E;for(let c=0;c<t;c++)try{return await r()}catch(C){if(E=C,!i(C)||c===t-1)throw C;let y=Math.min(o*Math.pow(a,c),n);await new Promise(L=>setTimeout(L,y))}throw E}function te(r){return r.name==="NetworkError"||!navigator.onLine?new T(p.NETWORK,m.NETWORK,{offline:!navigator.onLine}):r.name==="TimeoutError"?new T("Request timed out. Please try again.",m.TIMEOUT):new T(r.message||p.NETWORK,m.NETWORK,{originalError:r})}function re(r){if(!r.ok)throw new T(`HTTP error! status: ${r.status}`,m.NETWORK,{status:r.status,statusText:r.statusText});return r}function Le(r){return new Promise((e,t)=>{setTimeout(()=>{t(new T("Operation timed out",m.TIMEOUT))},r)})}async function oe(r,e){return Promise.race([r,Le(e)])}var ye,m,T,ne=A(()=>{R();S();ye=f("ErrorHandler"),m={NETWORK:"NETWORK_ERROR",VALIDATION:"VALIDATION_ERROR",PERMISSION:"PERMISSION_ERROR",TIMEOUT:"TIMEOUT_ERROR",PARSE:"PARSE_ERROR",UNKNOWN:"UNKNOWN_ERROR"},T=class extends Error{constructor(e,t=m.UNKNOWN,o={}){super(e),this.name="AppError",this.type=t,this.details=o,this.timestamp=new Date().toISOString()}}});var se={};de(se,{ApiClient:()=>b,apiClient:()=>k,clearExpiredCache:()=>ae,loadJSON:()=>Me,submitForm:()=>Fe});function xe(r){let e=I.get(r);return e&&e.expires>Date.now()?e.data:(I.delete(r),null)}function be(r,e,t){I.set(r,{data:e,expires:Date.now()+t})}function ae(){let r=Date.now();for(let[e,t]of I.entries())t.expires<=r&&I.delete(e)}var we,De,b,k,Fe,Me,I,ie=A(()=>{ne();R();S();we=f("ApiClient"),De={timeout:3e4,retries:3,headers:{"Content-Type":"application/json",Accept:"application/json"}},b=class{constructor(e={}){this.config=l(l({},De),e),this.baseURL=e.baseURL||""}async request(e,t={}){let o=this.baseURL+e,n=d(l({},t),{headers:l(l({},this.config.headers),t.headers)});if(n.method!=="GET"){let a=await this.getCSRFToken();a&&(n.headers["X-CSRF-Token"]=a)}try{let a=await ee(async()=>{let E=fetch(o,n),c=await oe(E,t.timeout||this.config.timeout);return re(c)},{maxRetries:t.retries||this.config.retries,shouldRetry:E=>{var c;return E.type===m.NETWORK||((c=E.details)==null?void 0:c.status)>=500}}),i=a.headers.get("content-type");return i&&i.includes("application/json")?await a.json():await a.text()}catch(a){throw te(a)}}async get(e,t={}){return this.request(e,d(l({},t),{method:"GET"}))}async post(e,t,o={}){return this.request(e,d(l({},o),{method:"POST",body:JSON.stringify(t)}))}async put(e,t,o={}){return this.request(e,d(l({},o),{method:"PUT",body:JSON.stringify(t)}))}async delete(e,t={}){return this.request(e,d(l({},t),{method:"DELETE"}))}async getCSRFToken(){try{let e=await fetch(F.CSRF_TOKEN);if(e.ok)return(await e.json()).token}catch(e){we.warn("Failed to get CSRF token:",e)}return null}},k=new b,Fe=G(async(r,e,t={})=>{let o=e instanceof FormData?e:new FormData;return e instanceof FormData||Object.entries(e).forEach(([a,i])=>{o.append(a,i)}),await k.request(r,d(l({},t),{method:"POST",body:o,headers:{Accept:"application/json"}}))},{errorMessage:"Form submission failed. Please try again.",trackError:!0}),Me=G(async(r,e={})=>{let t=`json_cache_${r}`,o=e.cacheDuration||36e5;if(e.useCache){let a=xe(t);if(a)return a}let n=await k.get(r,e);return e.useCache&&be(t,n,o),n},{errorMessage:"Failed to load data. Please try again.",fallbackValue:null}),I=new Map;setInterval(ae,D.REMINDER_CHECK_INTERVAL)});R();function Y(r,e=D.DEBOUNCE_DEFAULT){if(typeof r!="function")throw new TypeError("First argument must be a function");let t;return function(...n){let a=()=>{clearTimeout(t),r(...n)};clearTimeout(t),t=setTimeout(a,e)}}S();var _e=f("SafeDOM");function U(r,e=document){try{return e.querySelector(r)}catch(t){return _e.warn(`Failed to query selector "${r}":`,t),null}}S();var J=f("EventCleanup"),g=new Map;function N(r,e,t,o){if(!r||typeof r.addEventListener!="function"){J.warn("Invalid element provided to addEventListenerWithCleanup");return}r.addEventListener(e,t,o),g.has(r)||g.set(r,[]),g.get(r).push({event:e,handler:t,options:o})}function Ce(r=null){if(r){let e=g.get(r);e&&(e.forEach(({event:t,handler:o,options:n})=>{r.removeEventListener(t,o,n)}),g.delete(r))}else g.forEach((e,t)=>{e.forEach(({event:o,handler:n,options:a})=>{try{t.removeEventListener(o,n,a)}catch(i){J.warn("Failed to remove event listener:",i)}})}),g.clear()}typeof window!="undefined"&&window.addEventListener("beforeunload",()=>{Ce()});S();var st=f("Helpers");function Q(r){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(r)}function Z(r){return/^\(?([0-9]{3})\)?[-. ]?([0-9]{3})[-. ]?([0-9]{4})$/.test(r)}S();R();var _=f("ContactPage");function ce(){let r=U("#contact-form");r&&ve(r);let e=U("#meeting-location-map");e&&We(e),Be()}function ve(r){r.querySelectorAll("input, textarea").forEach(o=>{N(o,"blur",W),N(o,"input",Y(W,500))}),N(r,"submit",ke);let t=r.querySelector("#message");t&&Ge(t)}function W(r){let e=r.target,t=e.value.trim(),o=e.name||e.id;if(le(e),!t&&!e.required)return!0;let n=!0,a="";switch(o){case"name":case"firstName":case"lastName":t.length<2&&(n=!1,a="Name must be at least 2 characters long");break;case"email":Q(t)||(n=!1,a="Please enter a valid email address");break;case"phone":t&&!Z(t)&&(n=!1,a="Please enter a valid phone number (XXX) XXX-XXXX");break;case"message":t.length<10?(n=!1,a="Message must be at least 10 characters long"):t.length>1e3&&(n=!1,a="Message must be less than 1000 characters");break;case"subject":t.length<5&&(n=!1,a="Subject must be at least 5 characters long");break}return e.required&&!t&&(n=!1,a="This field is required"),n?Ue(e):Pe(e,a),n}function le(r){r.classList.remove("error","success");let e=r.parentNode.querySelector(".field-error");e&&e.remove()}function Pe(r,e){r.classList.add("error"),r.classList.remove("success");let t=document.createElement("div");t.className="field-error",t.textContent=e,t.setAttribute("role","alert"),r.parentNode.appendChild(t)}function Ue(r){r.classList.add("success"),r.classList.remove("error")}function Ge(r){let t=document.createElement("div");t.className="character-counter";let o=()=>{let n=1e3-r.value.length;t.textContent=`${n} characters remaining`,t.className=`character-counter ${n<50?"warning":""}`};r.parentNode.appendChild(t),N(r,"input",o),o()}async function ke(r){r.preventDefault();let e=r.target,t=e.querySelector('button[type="submit"]'),o=t.textContent,n=e.querySelectorAll("input[required], textarea[required]"),a=!0;if(n.forEach(i=>{W({target:i})||(a=!1)}),!a){H(p.VALIDATION_FAILED,M.ERROR);return}t.disabled=!0,t.textContent="Sending...";try{let i=new FormData(e),E=Object.fromEntries(i.entries()),c=await He();c&&(E.csrf_token=c);let{apiClient:C}=await Promise.resolve().then(()=>(ie(),se)),y=await fetch(F.CONTACT_FORM,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(E)}),L=await y.json();if(y.ok&&L.success)H(K.FORM_SUBMITTED,M.SUCCESS),e.reset(),n.forEach(ue=>le(ue)),typeof gtag=="function"&&gtag("event",v.CONTACT_FORM_SUBMIT,{success:!0});else throw new Error(L.message||p.SUBMISSION_FAILED)}catch(i){_.error("Form submission failed:",i),H(p.SUBMISSION_FAILED,M.ERROR),typeof gtag=="function"&&gtag("event",v.CONTACT_FORM_SUBMIT,{success:!1,error:i.message})}finally{t.disabled=!1,t.textContent=o}}function H(r,e){let t=document.querySelector(".form-message");t&&t.remove();let o=document.createElement("div");o.className=`form-message ${e}`,o.textContent=r,o.setAttribute("role","alert");let n=document.querySelector("#contact-form");n.insertBefore(o,n.firstChild),e==="success"&&setTimeout(()=>{o.remove()},1e4)}async function He(){try{return(await(await fetch("csrf-token.php")).json()).token}catch(r){return _.warn("Failed to get CSRF token:",r),null}}function We(r){r.innerHTML=`
        <div class="map-container">
            <div class="map-placeholder">
                <h4>Meeting Location</h4>
                <address>
                    <strong>San Antonio Public Library</strong><br>
                    Central Branch - Conference Room B<br>
                    600 Soledad Street<br>
                    San Antonio, TX 78205
                </address>
                <div class="map-actions">
                    <a href="https://www.google.com/maps/search/?api=1&query=San+Antonio+Public+Library+Central+Branch" 
                       target="_blank" class="btn-secondary">
                        \u{1F4CD} Open in Google Maps
                    </a>
                    <button class="btn-secondary" onclick="copyAddress()">
                        \u{1F4CB} Copy Address
                    </button>
                </div>
            </div>
        </div>
    `,window.copyAddress=function(){let o="San Antonio Public Library, Central Branch - Conference Room B, 600 Soledad Street, San Antonio, TX 78205";navigator.clipboard?navigator.clipboard.writeText(o).then(()=>{e()}).catch(n=>{_.error("Failed to copy address:",n),t(o)}):t(o)};function e(){let o=r.querySelector('button[onclick="copyAddress()"]'),n=o.textContent;o.textContent="\u2705 Copied!",setTimeout(()=>{o.textContent=n},2e3)}function t(o){let n=document.createElement("textarea");n.value=o,n.style.position="fixed",n.style.opacity="0",document.body.appendChild(n),n.select();try{document.execCommand("copy"),e()}catch(a){_.error("Fallback copy failed:",a),alert("Please manually copy the address from above.")}document.body.removeChild(n)}}function Be(){document.querySelectorAll("[data-copy]").forEach(e=>{N(e,"click",t=>{let o=t.target.dataset.copy||t.target.textContent;navigator.clipboard&&navigator.clipboard.writeText(o).then(()=>{Ve(t.target)}).catch(n=>{_.error("Failed to copy:",n)})})})}function Ve(r){let e=r.textContent;r.textContent="Copied!",r.style.backgroundColor="#e8f5e8",setTimeout(()=>{r.textContent=e,r.style.backgroundColor=""},1500)}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",ce):ce();})();
