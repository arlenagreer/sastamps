import{c as w}from"./chunk-BUV2MSDD.min.js";var n=w("DataLoader"),l=class{constructor(){this.cache=new Map,this.cacheExpiry=new Map,this.defaultCacheDuration=5*60*1e3,this.baseDataPath="/data/"}async fetchData(e,t={}){let{cacheDuration:r=this.defaultCacheDuration,forceRefresh:s=!1}=t,a=this.baseDataPath+e,c=a;if(!s&&this.isCacheValid(c))return this.cache.get(c);try{let o=await fetch(a);if(!o.ok)throw new Error(`Failed to fetch ${e}: ${o.status} ${o.statusText}`);let i=await o.json();return this.validateData(e,i),this.setCache(c,i,r),i}catch(o){return n.error(`Error loading data from ${e}:`,o),this.cache.has(c)?this.cache.get(c):this.getFallbackData(e,o)}}async getNewsletters(e={}){return this.fetchData("newsletters/newsletters.json",e)}async getMeetings(e={}){return this.fetchData("meetings/meetings.json",e)}async getResources(e={}){return this.fetchData("members/resources.json",e)}async getGlossary(e={}){return this.fetchData("glossary/glossary.json",e)}async getUpcomingMeetings(){try{let e=await this.getMeetings(),t=new Date,r=new Date(t.getTime()+90*24*60*60*1e3);return e.meetings.filter(s=>{let a=new Date(s.date+"T00:00:00");return a>=t&&a<=r&&!s.cancelled}).sort((s,a)=>new Date(s.date+"T00:00:00")-new Date(a.date+"T00:00:00"))}catch(e){return n.error("Error getting upcoming meetings:",e),[]}}async getLatestNewsletter(){try{return(await this.getNewsletters()).newsletters.filter(t=>t.status==="published").sort((t,r)=>new Date(r.publishDate)-new Date(t.publishDate))[0]||null}catch(e){return n.error("Error getting latest newsletter:",e),null}}async search(e,t=["newsletters","meetings","resources","glossary"]){let r={newsletters:[],meetings:[],resources:[],glossary:[],total:0},s=[];t.includes("newsletters")&&s.push(this.searchNewsletters(e)),t.includes("meetings")&&s.push(this.searchMeetings(e)),t.includes("resources")&&s.push(this.searchResources(e)),t.includes("glossary")&&s.push(this.searchGlossary(e));try{let a=await Promise.all(s);return t.forEach((c,o)=>{r[c]=a[o]||[],r.total+=r[c].length}),r}catch(a){return n.error("Search error:",a),r}}async searchNewsletters(e){try{let t=await this.getNewsletters(),r=e.toLowerCase();return t.newsletters.filter(s=>s.title.toLowerCase().includes(r)||s.description.toLowerCase().includes(r)||s.highlights.some(a=>a.toLowerCase().includes(r))||s.tags.some(a=>a.toLowerCase().includes(r)))}catch(t){return n.error("Newsletter search error:",t),[]}}async searchMeetings(e){try{let t=await this.getMeetings(),r=e.toLowerCase();return t.meetings.filter(s=>{var a,c,o,i,u,h;return((a=s.title)==null?void 0:a.toLowerCase().includes(r))||((c=s.topic)==null?void 0:c.toLowerCase().includes(r))||((o=s.description)==null?void 0:o.toLowerCase().includes(r))||((u=(i=s.presenter)==null?void 0:i.name)==null?void 0:u.toLowerCase().includes(r))||((h=s.tags)==null?void 0:h.some(g=>g.toLowerCase().includes(r)))})}catch(t){return n.error("Meeting search error:",t),[]}}async searchResources(e){try{let t=await this.getResources(),r=e.toLowerCase();return t.resources.filter(s=>s.title.toLowerCase().includes(r)||s.summary.toLowerCase().includes(r)||s.content.toLowerCase().includes(r)||s.tags.some(a=>a.toLowerCase().includes(r)))}catch(t){return n.error("Resource search error:",t),[]}}async searchGlossary(e){try{let t=await this.getGlossary(),r=e.toLowerCase();return t.terms.filter(s=>{var a,c;return s.term.toLowerCase().includes(r)||s.definition.toLowerCase().includes(r)||((a=s.alternateNames)==null?void 0:a.some(o=>o.toLowerCase().includes(r)))||((c=s.tags)==null?void 0:c.some(o=>o.toLowerCase().includes(r)))})}catch(t){return n.error("Glossary search error:",t),[]}}isCacheValid(e){if(!this.cache.has(e))return!1;let t=this.cacheExpiry.get(e);return t&&Date.now()<t}setCache(e,t,r){this.cache.set(e,t),this.cacheExpiry.set(e,Date.now()+r)}clearCache(){this.cache.clear(),this.cacheExpiry.clear()}validateData(e,t){if(!t||typeof t!="object")throw new Error(`Invalid data format for ${e}`);if(e.includes("newsletters")){if(!t.newsletters||!Array.isArray(t.newsletters))throw new Error("Newsletter data must contain newsletters array")}else if(e.includes("meetings")){if(!t.meetings||!Array.isArray(t.meetings))throw new Error("Meeting data must contain meetings array")}else if(e.includes("resources")){if(!t.resources||!Array.isArray(t.resources))throw new Error("Resource data must contain resources array")}else if(e.includes("glossary")&&(!t.terms||!Array.isArray(t.terms)))throw new Error("Glossary data must contain terms array")}getFallbackData(e,t){return n.warn(`Using fallback data for ${e}:`,t.message),e.includes("newsletters")?{newsletters:[],metadata:{error:!0,message:"Failed to load newsletter data",lastUpdated:new Date().toISOString()}}:e.includes("meetings")?{meetings:[],metadata:{error:!0,message:"Failed to load meeting data",lastUpdated:new Date().toISOString()}}:e.includes("resources")?{resources:[],metadata:{error:!0,message:"Failed to load resource data",lastUpdated:new Date().toISOString()}}:e.includes("glossary")?{terms:[],metadata:{error:!0,message:"Failed to load glossary data",lastUpdated:new Date().toISOString()}}:{error:!0,message:"Failed to load data",endpoint:e}}},d=new l,y=d;typeof window!="undefined"&&(window.dataLoader=d);export{y as default};
